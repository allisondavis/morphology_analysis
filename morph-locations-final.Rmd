---
title: "morph-locations-final"
author: "Allison Davis Connelly"
date: "2024-02-24"
output: 
  html_document:
    toc: TRUE
    toc_depth: 6
    toc_float:
      collapsed: FALSE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Data collection 

```{r, echo=FALSE}
library(curl)

raw <- curl("https://raw.githubusercontent.com/allisondavis/morphology_analysis/master/adavis_morphology_raw-data_FINAL.csv")

raw <- read.csv(raw, header = TRUE, sep = ",", stringsAsFactors = TRUE)

                                                                                                           
raw1 <- raw[, -25] #removed total length, since I'm not really using it and don't want an NAs here to remove specimen
raw1 <- raw1[complete.cases(raw1[, 15:36]),] #issues with binding data later, so making a df without NAs now to see if it helps


raw1[paste0(names(raw1), '_log')] <- log(raw1[, 26:35], 10)
#for some reason did the log of the whole data frame instead of those specific columns, so I will just remove the unnecessary columns instead of spending time on what went wrong.

raw1 <- raw1[-c(37:60)]
raw1 <- raw1[-c(48)]



#cubed root
raw1$cbR_BD ='^'(raw1$BD,1/3)
raw1$cbR_PreDL ='^'(raw1$PreDL,1/3)
raw1$cbR_DbL ='^'(raw1$DbL,1/3)


#raw1 <- raw1[-c(48:50)]
#need to cube root SL to use in regressions

raw1$cbR_SL ='^'(raw1$SL,1/3)

library(dplyr) 
library(ggplot2)
library(ggpubr)



lat <- raw1[raw1$SPP == "p.latipinna",]


form <- raw1[raw1$SPP == "p.formosa",]


mex <- raw1[raw1$SPP == "p.mexicana",]



##### LAT #####
reg.lat.D <- lm(lat$D ~ lat$SL)
sd.lat.D <- rstandard(reg.lat.D)


reg.lat.P1 <- lm(lat$P1 ~ lat$SL)
sd.lat.P1 <- rstandard(reg.lat.P1)


reg.lat.P2.L <- lm(lat$P2.L ~ lat$SL)
sd.lat.P2.L <- rstandard(reg.lat.P2.L)


reg.lat.P2.R <- lm(lat$P2.R ~ lat$SL)
sd.lat.P2.R <- rstandard(reg.lat.P2.R)


reg.lat.A <- lm(lat$A ~ lat$SL)
sd.lat.A <- rstandard(reg.lat.A)


reg.lat.P1.R <- lm(lat$P1.R ~ lat$SL)
sd.lat.P1.R <- rstandard(reg.lat.P1.R)


reg.lat.LLSC <- lm(lat$LLSC ~ lat$SL)
sd.lat.LLSC <- rstandard(reg.lat.LLSC)


reg.lat.SALL <- lm(lat$SALL ~ lat$SL)
sd.lat.SALL <- rstandard(reg.lat.SALL)


reg.lat.SBLL <- lm(lat$SBLL ~ lat$SL)
sd.lat.SBLL <- rstandard(reg.lat.SBLL)


reg.lat.SBDF <- lm(lat$SBDF ~ lat$SL)
sd.lat.SBDF <- rstandard(reg.lat.SBDF)


reg.lat.BD <- lm(lat$cbR_BD ~ lat$cbR_SL)
sd.lat.BD <- rstandard(reg.lat.BD)


reg.lat.CPD <- lm(lat$CPD_log ~ lat$SL_log)
sd.lat.CPD <- rstandard(reg.lat.CPD)


reg.lat.CPL <- lm(lat$CPL_log ~ lat$SL_log)
sd.lat.CPL <- rstandard(reg.lat.CPL)


reg.lat.PreDL <- lm(lat$cbR_PreDL ~ lat$cbR_SL)
sd.lat.PreDL <- rstandard(reg.lat.PreDL)


reg.lat.DbL <- lm(lat$cbR_DbL ~ lat$cbR_SL)
sd.lat.DbL <- rstandard(reg.lat.DbL)


reg.lat.HL <- lm(lat$HL_log ~ lat$SL_log)
sd.lat.HL <- rstandard(reg.lat.HL)


reg.lat.HD <- lm(lat$HD_log ~ lat$SL_log)
sd.lat.HD <- rstandard(reg.lat.HD)


reg.lat.HW <- lm(lat$HW_log ~ lat$SL_log)
sd.lat.HW <- rstandard(reg.lat.HW)


reg.lat.SnL <- lm(lat$SnL_log ~ lat$SL_log)
sd.lat.SnL <- rstandard(reg.lat.SnL)


reg.lat.OL <- lm(lat$OL_log ~ lat$SL_log)
sd.lat.OL <- rstandard(reg.lat.OL)


reg.lat.FLA <- lm(lat$FLA ~ lat$SL)
sd.lat.FLA <- rstandard(reg.lat.FLA)


##### FORM #####

reg.form.D <- lm(form$D ~ form$SL)
sd.form.D <- rstandard(reg.form.D)


reg.form.P1 <- lm(form$P1 ~ form$SL)
sd.form.P1 <- rstandard(reg.form.P1)


reg.form.P2.L <- lm(form$P2.L ~ form$SL)
sd.form.P2.L <- rstandard(reg.form.P2.L)


reg.form.P2.R <- lm(form$P2.R ~ form$SL)
sd.form.P2.R <- rstandard(reg.form.P2.R)


reg.form.A <- lm(form$A ~ form$SL)
sd.form.A <- rstandard(reg.form.A)


reg.form.P1.R <- lm(form$P1.R ~ form$SL)
sd.form.P1.R <- rstandard(reg.form.P1.R)


reg.form.LLSC <- lm(form$LLSC ~ form$SL)
sd.form.LLSC <- rstandard(reg.form.LLSC)


reg.form.SALL <- lm(form$SALL ~ form$SL)
sd.form.SALL <- rstandard(reg.form.SALL)


reg.form.SBLL <- lm(form$SBLL ~ form$SL)
sd.form.SBLL <- rstandard(reg.form.SBLL)


reg.form.SBDF <- lm(form$SBDF ~ form$SL)
sd.form.SBDF <- rstandard(reg.form.SBDF)


reg.form.BD <- lm(form$cbR_BD ~ form$cbR_SL)
sd.form.BD <- rstandard(reg.form.BD)


reg.form.CPD <- lm(form$CPD_log ~ form$SL_log)
sd.form.CPD <- rstandard(reg.form.CPD)
reg.form.CPD.plot <- ggplot(form, aes(x = SL_log, y = CPD_log)) + 
  geom_point() +
  stat_smooth(method = "lm", col = "red") +
  stat_cor(label.y = 10)
reg.form.CPD.plot

reg.form.CPL <- lm(form$CPL_log ~ form$SL_log)
sd.form.CPL <- rstandard(reg.form.CPL)


reg.form.PreDL <- lm(form$cbR_PreDL ~ form$cbR_SL)
sd.form.PreDL <- rstandard(reg.form.PreDL)


reg.form.DbL <- lm(form$cbR_DbL ~ form$cbR_SL)
sd.form.DbL <- rstandard(reg.form.DbL)


reg.form.HL <- lm(form$HL_log ~ form$SL_log)
sd.form.HL <- rstandard(reg.form.HL)


reg.form.HD <- lm(form$HD_log ~ form$SL_log)
sd.form.HD <- rstandard(reg.form.HD)


reg.form.HW <- lm(form$HW_log ~ form$SL_log)
sd.form.HW <- rstandard(reg.form.HW)


reg.form.SnL <- lm(form$SnL_log ~ form$SL_log)
sd.form.SnL <- rstandard(reg.form.SnL)


reg.form.OL <- lm(form$OL_log ~ form$SL_log)
sd.form.OL <- rstandard(reg.form.OL)


reg.form.FLA <- lm(form$FLA ~ form$SL)
sd.form.FLA <- rstandard(reg.form.FLA)




##### MEX #####
reg.mex.D <- lm(mex$D ~ mex$SL)
sd.mex.D <- rstandard(reg.mex.D)


reg.mex.P1 <- lm(mex$P1 ~ mex$SL)
sd.mex.P1 <- rstandard(reg.mex.P1)


reg.mex.P2.L <- lm(mex$P2.L ~ mex$SL)
sd.mex.P2.L <- rstandard(reg.mex.P2.L)


reg.mex.P2.R <- lm(mex$P2.R ~ mex$SL)
sd.mex.P2.R <- rstandard(reg.mex.P2.R)


reg.mex.A <- lm(mex$A ~ mex$SL)
sd.mex.A <- rstandard(reg.mex.A)


reg.mex.P1.R <- lm(mex$P1.R ~ mex$SL)
sd.mex.P1.R <- rstandard(reg.mex.P1.R)


reg.mex.LLSC <- lm(mex$LLSC ~ mex$SL)
sd.mex.LLSC <- rstandard(reg.mex.LLSC)


reg.mex.SALL <- lm(mex$SALL ~ mex$SL)
sd.mex.SALL <- rstandard(reg.mex.SALL)


reg.mex.SBLL <- lm(mex$SBLL ~ mex$SL)
sd.mex.SBLL <- rstandard(reg.mex.SBLL)


reg.mex.SBDF <- lm(mex$SBDF ~ mex$SL)
sd.mex.SBDF <- rstandard(reg.mex.SBDF)


reg.mex.BD <- lm(mex$cbR_BD ~ mex$cbR_SL)
sd.mex.BD <- rstandard(reg.mex.BD)


reg.mex.CPD <- lm(mex$CPD_log ~ mex$SL_log)
sd.mex.CPD <- rstandard(reg.mex.CPD)


reg.mex.CPL <- lm(mex$CPL_log ~ mex$SL_log)
sd.mex.CPL <- rstandard(reg.mex.CPL)


reg.mex.PreDL <- lm(mex$cbR_PreDL ~ mex$cbR_SL)
sd.mex.PreDL <- rstandard(reg.mex.PreDL)


reg.mex.DbL <- lm(mex$cbR_DbL ~ mex$cbR_SL)
sd.mex.DbL <- rstandard(reg.mex.DbL)


reg.mex.HL <- lm(mex$HL_log ~ mex$SL_log)
sd.mex.HL <- rstandard(reg.mex.HL)


reg.mex.HD <- lm(mex$HD_log ~ mex$SL_log)
sd.mex.HD <- rstandard(reg.mex.HD)


reg.mex.HW <- lm(mex$HW_log ~ mex$SL_log)
sd.mex.HW <- rstandard(reg.mex.HW)

reg.mex.SnL <- lm(mex$SnL_log ~ mex$SL_log)
sd.mex.SnL <- rstandard(reg.mex.SnL)


reg.mex.OL <- lm(mex$OL_log ~ mex$SL_log)
sd.mex.OL <- rstandard(reg.mex.OL)


reg.mex.FLA <- lm(mex$FLA ~ mex$SL)
sd.mex.FLA <- rstandard(reg.mex.FLA)


##### LAT #####
res.lat.D <- resid(reg.lat.D)

res.lat.P1 <- resid(reg.lat.P1)

res.lat.P1.R <- resid(reg.lat.P1.R)

res.lat.LLSC <- resid(reg.lat.LLSC)

res.lat.SBLL <- resid(reg.lat.SBLL) #will only be used when comparing with p.mex; raw data used otherwise

res.lat.BD <- resid(reg.lat.BD)

res.lat.CPD <- resid(reg.lat.CPD)

res.lat.CPL <- resid(reg.lat.CPL)

res.lat.PreDL <- resid(reg.lat.PreDL)

res.lat.DbL <- resid(reg.lat.DbL)

res.lat.HL <- resid(reg.lat.HL)

res.lat.HD <- resid(reg.lat.HD)

res.lat.HW <- resid(reg.lat.HW)

res.lat.SnL <- resid(reg.lat.SnL)

res.lat.OL <- resid(reg.lat.OL)

##### FORM #####

res.form.D <- resid(reg.form.D)

res.form.P1 <- resid(reg.form.P1)

res.form.P1.R <- resid(reg.form.P1.R)

res.form.LLSC <- resid(reg.form.LLSC)

res.form.SBLL <- resid(reg.form.SBLL) #will only be used when comparing with p.mex; raw data used otherwise

res.form.BD <- resid(reg.form.BD)

res.form.CPD <- resid(reg.form.CPD)

res.form.CPL <- resid(reg.form.CPL)

res.form.PreDL <- resid(reg.form.PreDL)

res.form.DbL <- resid(reg.form.DbL)

res.form.HL <- resid(reg.form.HL)

res.form.HD <- resid(reg.form.HD)

res.form.HW <- resid(reg.form.HW)

res.form.SnL <- resid(reg.form.SnL)

res.form.OL <- resid(reg.form.OL)


##### MEX #####
res.mex.D <- resid(reg.mex.D)

res.mex.P1 <- resid(reg.mex.P1)

res.mex.P1.R <- resid(reg.mex.P1.R)

res.mex.LLSC <- resid(reg.mex.LLSC)

res.mex.SBLL <- resid(reg.mex.SBLL)

res.mex.BD <- resid(reg.mex.BD)

res.mex.CPD <- resid(reg.mex.CPD)

res.mex.CPL <- resid(reg.mex.CPL)

res.mex.PreDL <- resid(reg.mex.PreDL)

res.mex.DbL <- resid(reg.mex.DbL)

res.mex.HL <- resid(reg.mex.HL)

res.mex.HD <- resid(reg.mex.HD)

res.mex.HW <- resid(reg.mex.HW)

res.mex.SnL <- resid(reg.mex.SnL)

res.mex.OL <- resid(reg.mex.OL)


##### LAT #####

abs.lat.D <- abs(res.lat.D)

abs.lat.P1 <- abs(res.lat.P1)

abs.lat.P1.R <- abs(res.lat.P1.R)

abs.lat.LLSC <- abs(res.lat.LLSC)

abs.lat.SBLL <- abs(res.lat.SBLL)

abs.lat.BD <- abs(res.lat.BD)

abs.lat.CPD <- abs(res.lat.CPD)

abs.lat.CPL <- abs(res.lat.CPL)

abs.lat.PreDL <- abs(res.lat.PreDL)

abs.lat.DbL <- abs(res.lat.DbL)

abs.lat.HL <- abs(res.lat.HL)

abs.lat.HD <- abs(res.lat.HD)

abs.lat.HW <- abs(res.lat.HW)

abs.lat.SnL <- abs(res.lat.SnL)

abs.lat.OL <- abs(res.lat.OL)


##### FORM #####

abs.form.D <- abs(res.form.D)

abs.form.P1 <- abs(res.form.P1)

abs.form.P1.R <- abs(res.form.P1.R)

abs.form.LLSC <- abs(res.form.LLSC)

abs.form.SBLL <- abs(res.form.SBLL)

abs.form.BD <- abs(res.form.BD)

abs.form.CPD <- abs(res.form.CPD)

abs.form.CPL <- abs(res.form.CPL)

abs.form.PreDL <- abs(res.form.PreDL)

abs.form.DbL <- abs(res.form.DbL)

abs.form.HL <- abs(res.form.HL)

abs.form.HD <- abs(res.form.HD)

abs.form.HW <- abs(res.form.HW)

abs.form.SnL <- abs(res.form.SnL)

abs.form.OL <- abs(res.form.OL)

##### MEX #####

abs.mex.D <- abs(res.mex.D)

abs.mex.P1 <- abs(res.mex.P1)

abs.mex.P1.R <- abs(res.mex.P1.R)

abs.mex.LLSC <- abs(res.mex.LLSC)

abs.mex.SBLL <- abs(res.mex.SBLL)

abs.mex.BD <- abs(res.mex.BD)

abs.mex.CPD <- abs(res.mex.CPD)

abs.mex.CPL <- abs(res.mex.CPL)

abs.mex.PreDL <- abs(res.mex.PreDL)

abs.mex.DbL <- abs(res.mex.DbL)

abs.mex.HL <- abs(res.mex.HL)

abs.mex.HD <- abs(res.mex.HD)

abs.mex.HW <- abs(res.mex.HW)

abs.mex.SnL <- abs(res.mex.SnL)

abs.mex.OL <- abs(res.mex.OL)



#let's get this into the raw1 data set so that we can plot this more easily

abs.res.D <- c(abs.lat.D, abs.form.D, abs.mex.D)
abs.res.P1 <- c(abs.lat.P1, abs.form.P1, abs.mex.P1)
abs.res.P1.R <- c(abs.lat.P1.R, abs.form.P1.R, abs.mex.P1.R)
abs.res.LLSC<- c(abs.lat.LLSC, abs.form.LLSC, abs.mex.LLSC)
abs.res.SBLL<- c(abs.lat.SBLL, abs.form.SBLL, abs.mex.SBLL)
abs.res.BD<- c(abs.lat.BD, abs.form.BD, abs.mex.BD)
abs.res.CPD<- c(abs.lat.CPD, abs.form.CPD, abs.mex.CPD)
abs.res.CPL<- c(abs.lat.CPL, abs.form.CPL, abs.mex.CPL)
abs.res.PreDL <- c(abs.lat.PreDL, abs.form.PreDL, abs.mex.PreDL)
abs.res.DbL <- c(abs.lat.DbL, abs.form.DbL, abs.mex.DbL)
abs.res.HL<- c(abs.lat.HL, abs.form.HL, abs.mex.HL)
abs.res.HD<- c(abs.lat.HD, abs.form.HD, abs.mex.HD)
abs.res.HW <- c(abs.lat.HW, abs.form.HW, abs.mex.HW)
abs.res.SnL <- c(abs.lat.SnL, abs.form.SnL, abs.mex.SnL)
abs.res.OL <- c(abs.lat.OL, abs.form.OL, abs.mex.OL)


raw2 <- cbind(raw1, abs.res.D, abs.res.P1, abs.res.P1.R, abs.res.LLSC, abs.res.SBLL, abs.res.BD, abs.res.CPD, abs.res.CPL, abs.res.PreDL, abs.res.DbL, abs.res.HL, abs.res.HD, abs.res.HW, abs.res.SnL, abs.res.OL)

raw3 <- raw2[raw2$SPP !="p.mexicana", ]


```


## Location effects

Will run an ANOVA on the residuals with location and species as fixed effects. This will show me if morphology depends on the species, the location, and if the location and species interact to determine morphology. CANNOT DO WITH COUNT DATA--may have to run a glmer with zero-tuncated negative binomial/quasi-poisson distribution instead (think this will tell me if species, location, and interaction affect the trait...). Will only work with the residuals, because comparing the means of the residuals indicates differences in variation. **Would I not just use Levene's and MWU again but include spp and zone/basin/watershed?**

Leaving the anovas for count data in rn until I figure out what to do.

I will first run this using the zones as the location factor. Zones (1-4) represent the latitude range with equivalent sample sizes in each, since the collections were not equally representative of all latitudes, and I wanted to avoid a sampling bias when randomly selecting samples. Zone 1 corresponds to the southern most latitude range, and zone 4 corresponds to the northern most latitude range.

I will then run the same analysis using basin as the location factor. Since fish are physically isolated to the river basins they occupy, the genetic variation is also limited to that basin. Thus it is possible for fish within the same basin to be more similar due to genetic/physical constraints. (will also do with watershed just to see).

Lastly I will run ANOVAs with both zones and basins but with standardized residuals. This would allow me to compare overall variation across traits (at least those that are depended on body size) rather than just one trait at a time. Not 100% sure if this is useful (or correct to do), but thought it would be interesting.

# All data


### ANOVAs {.tabset .tabset-fade .tabset-pills}

#### Amazon

##### Zones 

```{r}
library(ggplot2)

lat3 <- raw2[raw2$SPP == "p.latipinna", ]

form3 <- raw2[raw2$SPP == "p.latipinna", ]

A.D.F <- aov(abs.res.D ~ QUARTILE, data=form3)
summary(A.D.F)

ggplot(form3, aes(x=factor(QUARTILE), y=abs.res.D)) +
  geom_boxplot()


A.P1.F <- aov(abs.res.P1 ~ QUARTILE, data=form3)
summary(A.P1.F)

A.P1.R.F <- aov(abs.res.P1.R ~ QUARTILE, data=form3)
summary(A.P1.R.F)

ggplot(form3, aes(x=factor(QUARTILE), y=abs.res.P1.R)) +
  geom_boxplot()


A.LLSC.F <- aov(abs.res.LLSC ~ QUARTILE, data=form3)
summary(A.LLSC.F)


A.SBLL.F <- aov(abs.res.SBLL ~ QUARTILE, data=form3)
summary(A.SBLL.F)

ggplot(form3, aes(x=factor(QUARTILE), y=abs.res.SBLL)) +
  geom_boxplot()


A.BD.F <- aov(abs.res.BD ~ QUARTILE, data=form3)
summary(A.BD.F)

ggplot(form3, aes(x=factor(QUARTILE), y=abs.res.BD)) +
  geom_boxplot()


A.CPD.F <- aov(abs.res.CPD ~ QUARTILE, data=form3)
summary(A.CPD.F)

ggplot(form3, aes(x=factor(QUARTILE), y=abs.res.CPD)) +
  geom_boxplot()


A.CPL.F <- aov(abs.res.CPL ~ QUARTILE, data=form3)
summary(A.CPL.F)

ggplot(form3, aes(x=factor(QUARTILE), y=abs.res.CPL)) +
  geom_boxplot()


A.PreDL.F <- aov(abs.res.PreDL ~ QUARTILE, data=form3)
summary(A.PreDL.F)

ggplot(form3, aes(x=factor(QUARTILE), y=abs.res.PreDL)) +
  geom_boxplot()


A.DbL.F <- aov(abs.res.DbL ~ QUARTILE, data=form3)
summary(A.DbL.F)

ggplot(form3, aes(x=factor(QUARTILE), y=abs.res.DbL)) +
  geom_boxplot()


A.HL.F <- aov(abs.res.HL ~ QUARTILE, data=form3)
summary(A.HL.F)

ggplot(form3, aes(x=factor(QUARTILE), y=abs.res.HL)) +
  geom_boxplot()


A.HD.F <- aov(abs.res.HD ~ QUARTILE, data=form3)
summary(A.HD.F)

A.HW.F <- aov(abs.res.HW ~ QUARTILE, data=form3)
summary(A.HW.F)

ggplot(form3, aes(x=factor(QUARTILE), y=abs.res.HW)) +
  geom_boxplot()


A.SnL.F <- aov(abs.res.SnL ~ QUARTILE, data=form3)
summary(A.SnL.F)

A.OL.F <- aov(abs.res.OL ~ QUARTILE, data=form3)
summary(A.OL.F)

ggplot(form3, aes(x=factor(QUARTILE), y=abs.res.OL)) +
  geom_boxplot()


```

##### Basins 

```{r}

A1.D.F <- aov(abs.res.D ~ BASIN, data=form3)
summary(A1.D.F)

ggplot(form3, aes(x=factor(BASIN), y=abs.res.D)) +
  geom_boxplot()


A1.P1.F <- aov(abs.res.P1 ~ BASIN, data=form3)
summary(A1.P1.F)

A1.P1.R.F <- aov(abs.res.P1.R ~ BASIN, data=form3)
summary(A1.P1.R.F)

ggplot(form3, aes(x=factor(BASIN), y=abs.res.P1.R)) +
  geom_boxplot()

A1.LLSC.F <- aov(abs.res.LLSC ~ BASIN, data=form3)
summary(A1.LLSC.F)

ggplot(form3, aes(x=factor(BASIN), y=abs.res.LLSC)) +
  geom_boxplot()



A1.SBLL.F <- aov(abs.res.SBLL ~ BASIN, data=form3)
summary(A1.SBLL.F)

ggplot(form3, aes(x=factor(BASIN), y=abs.res.SBLL)) +
  geom_boxplot()

A1.BD.F <- aov(abs.res.BD ~ BASIN, data=form3)
summary(A1.BD.F)

ggplot(form3, aes(x=factor(BASIN), y=abs.res.BD)) +
  geom_boxplot()

A1.CPD.F <- aov(abs.res.CPD ~ BASIN, data=form3)
summary(A1.CPD.F)

ggplot(form3, aes(x=factor(BASIN), y=abs.res.CPD)) +
  geom_boxplot()

A1.CPL.F <- aov(abs.res.CPL ~ BASIN, data=form3)
summary(A1.CPL.F)

A1.PreDL.F <- aov(abs.res.PreDL ~ BASIN, data=form3)
summary(A1.PreDL.F)

ggplot(form3, aes(x=factor(BASIN), y=abs.res.PreDL)) +
  geom_boxplot()

A1.DbL.F <- aov(abs.res.DbL ~ BASIN, data=form3)
summary(A1.DbL.F)

ggplot(form3, aes(x=factor(BASIN), y=abs.res.DbL)) +
  geom_boxplot()

A1.HL.F <- aov(abs.res.HL ~ BASIN, data=form3)
summary(A1.HL.F)

ggplot(form3, aes(x=factor(BASIN), y=abs.res.HL)) +
  geom_boxplot()

A1.HD.F <- aov(abs.res.HD ~ BASIN, data=form3)
summary(A1.HD.F)

ggplot(form3, aes(x=factor(BASIN), y=abs.res.HD)) +
  geom_boxplot()

A1.HW.F <- aov(abs.res.HW ~ BASIN, data=form3)
summary(A1.HW.F)

ggplot(form3, aes(x=factor(BASIN), y=abs.res.HW)) +
  geom_boxplot()

A1.SnL.F <- aov(abs.res.SnL ~ BASIN, data=form3)
summary(A1.SnL.F)

A1.OL.F <- aov(abs.res.OL ~ BASIN, data=form3)
summary(A1.OL.F)

ggplot(form3, aes(x=factor(BASIN), y=abs.res.OL)) +
  geom_boxplot()




```

##### Watersheds 

```{r}

A2.D.F <- aov(abs.res.D ~ WATERSHED, data=form3)
summary(A2.D.F)

ggplot(form3, aes(x=factor(WATERSHED), y=abs.res.D)) +
  geom_boxplot()

A2.P1.F <- aov(abs.res.P1 ~ WATERSHED, data=form3)
summary(A2.P1.F)

A2.P1.R.F <- aov(abs.res.P1.R ~ WATERSHED, data=form3)
summary(A2.P1.R.F)

ggplot(form3, aes(x=factor(WATERSHED), y=abs.res.P1.R)) +
  geom_boxplot()

A2.LLSC.F <- aov(abs.res.LLSC ~ WATERSHED, data=form3)
summary(A2.LLSC.F)

ggplot(form3, aes(x=factor(WATERSHED), y=abs.res.LLSC)) +
  geom_boxplot()



A2.SBLL.F <- aov(abs.res.SBLL ~ WATERSHED, data=form3)
summary(A2.SBLL.F)

ggplot(form3, aes(x=factor(WATERSHED), y=abs.res.SBLL)) +
  geom_boxplot()

A2.BD.F <- aov(abs.res.BD ~ WATERSHED, data=form3)
summary(A2.BD.F)

ggplot(form3, aes(x=factor(WATERSHED), y=abs.res.BD)) +
  geom_boxplot()

A2.CPD.F <- aov(abs.res.CPD ~ WATERSHED, data=form3)
summary(A2.CPD.F)

ggplot(form3, aes(x=factor(WATERSHED), y=abs.res.CPD)) +
  geom_boxplot()

A2.CPL.F <- aov(abs.res.CPL ~ WATERSHED, data=form3)
summary(A2.CPL.F)

A2.PreDL.F <- aov(abs.res.PreDL ~ WATERSHED, data=form3)
summary(A2.PreDL.F)

A2.DbL.F <- aov(abs.res.DbL ~ WATERSHED, data=form3)
summary(A2.DbL.F)

ggplot(form3, aes(x=factor(WATERSHED), y=abs.res.DbL)) +
  geom_boxplot()

A2.HL.F <- aov(abs.res.HL ~ WATERSHED, data=form3)
summary(A2.HL.F)

ggplot(form3, aes(x=factor(WATERSHED), y=abs.res.HL)) +
  geom_boxplot()

A2.HD.F <- aov(abs.res.HD ~ WATERSHED, data=form3)
summary(A2.HD.F)

ggplot(form3, aes(x=factor(WATERSHED), y=abs.res.HD)) +
  geom_boxplot()

A2.HW.F <- aov(abs.res.HW ~ WATERSHED, data=form3)
summary(A2.HW.F)

ggplot(form3, aes(x=factor(WATERSHED), y=abs.res.HW)) +
  geom_boxplot()

A2.SnL.F <- aov(abs.res.SnL ~ WATERSHED, data=form3)
summary(A2.SnL.F)

A2.OL.F <- aov(abs.res.OL ~ WATERSHED, data=form3)
summary(A2.OL.F)

ggplot(form3, aes(x=factor(WATERSHED), y=abs.res.OL)) +
  geom_boxplot()




```

#### Sailfin


##### Zones 

```{r}
library(ggplot2)

A.D.L <- aov(abs.res.D ~ QUARTILE, data=lat3)
summary(A.D.L)

ggplot(lat3, aes(x=factor(QUARTILE), y=abs.res.D)) +
  geom_boxplot()


A.P1.L <- aov(abs.res.P1 ~ QUARTILE, data=lat3)
summary(A.P1.L)

A.P1.R.L <- aov(abs.res.P1.R ~ QUARTILE, data=lat3)
summary(A.P1.R.L)

ggplot(lat3, aes(x=factor(QUARTILE), y=abs.res.P1.R)) +
  geom_boxplot()


A.LLSC.L <- aov(abs.res.LLSC ~ QUARTILE, data=lat3)
summary(A.LLSC.L)


A.SBLL.L <- aov(abs.res.SBLL ~ QUARTILE, data=lat3)
summary(A.SBLL.L)

ggplot(lat3, aes(x=factor(QUARTILE), y=abs.res.SBLL)) +
  geom_boxplot()


A.BD.L <- aov(abs.res.BD ~ QUARTILE, data=lat3)
summary(A.BD.L)

ggplot(lat3, aes(x=factor(QUARTILE), y=abs.res.BD)) +
  geom_boxplot()


A.CPD.L <- aov(abs.res.CPD ~ QUARTILE, data=lat3)
summary(A.CPD.L)

ggplot(lat3, aes(x=factor(QUARTILE), y=abs.res.CPD)) +
  geom_boxplot()


A.CPL.L <- aov(abs.res.CPL ~ QUARTILE, data=lat3)
summary(A.CPL.L)

ggplot(lat3, aes(x=factor(QUARTILE), y=abs.res.CPL)) +
  geom_boxplot()


A.PreDL.L <- aov(abs.res.PreDL ~ QUARTILE, data=lat3)
summary(A.PreDL.L)

ggplot(lat3, aes(x=factor(QUARTILE), y=abs.res.PreDL)) +
  geom_boxplot()


A.DbL.L <- aov(abs.res.DbL ~ QUARTILE, data=lat3)
summary(A.DbL.L)

ggplot(lat3, aes(x=factor(QUARTILE), y=abs.res.DbL)) +
  geom_boxplot()


A.HL.L <- aov(abs.res.HL ~ QUARTILE, data=lat3)
summary(A.HL.L)

ggplot(lat3, aes(x=factor(QUARTILE), y=abs.res.HL)) +
  geom_boxplot()


A.HD.L <- aov(abs.res.HD ~ QUARTILE, data=lat3)
summary(A.HD.L)

A.HW.L <- aov(abs.res.HW ~ QUARTILE, data=lat3)
summary(A.HW.L)

ggplot(lat3, aes(x=factor(QUARTILE), y=abs.res.HW)) +
  geom_boxplot()


A.SnL.L <- aov(abs.res.SnL ~ QUARTILE, data=lat3)
summary(A.SnL.L)

A.OL.L <- aov(abs.res.OL ~ QUARTILE, data=lat3)
summary(A.OL.L)

ggplot(lat3, aes(x=factor(QUARTILE), y=abs.res.OL)) +
  geom_boxplot()


```

##### Basins 

```{r}

A1.D.L <- aov(abs.res.D ~ BASIN, data=lat3)
summary(A1.D.L)

ggplot(lat3, aes(x=factor(BASIN), y=abs.res.D)) +
  geom_boxplot()


A1.P1.L <- aov(abs.res.P1 ~ BASIN, data=lat3)
summary(A1.P1.L)

A1.P1.R.L <- aov(abs.res.P1.R ~ BASIN, data=lat3)
summary(A1.P1.R.L)

ggplot(lat3, aes(x=factor(BASIN), y=abs.res.P1.R)) +
  geom_boxplot()

A1.LLSC.L <- aov(abs.res.LLSC ~ BASIN, data=lat3)
summary(A1.LLSC.L)

ggplot(lat3, aes(x=factor(BASIN), y=abs.res.LLSC)) +
  geom_boxplot()



A1.SBLL.L <- aov(abs.res.SBLL ~ BASIN, data=lat3)
summary(A1.SBLL.L)

ggplot(lat3, aes(x=factor(BASIN), y=abs.res.SBLL)) +
  geom_boxplot()

A1.BD.L <- aov(abs.res.BD ~ BASIN, data=lat3)
summary(A1.BD.L)

ggplot(lat3, aes(x=factor(BASIN), y=abs.res.BD)) +
  geom_boxplot()

A1.CPD.L <- aov(abs.res.CPD ~ BASIN, data=lat3)
summary(A1.CPD.L)

ggplot(lat3, aes(x=factor(BASIN), y=abs.res.CPD)) +
  geom_boxplot()

A1.CPL.L <- aov(abs.res.CPL ~ BASIN, data=lat3)
summary(A1.CPL.L)

A1.PreDL.L <- aov(abs.res.PreDL ~ BASIN, data=lat3)
summary(A1.PreDL.L)

ggplot(lat3, aes(x=factor(BASIN), y=abs.res.PreDL)) +
  geom_boxplot()

A1.DbL.L <- aov(abs.res.DbL ~ BASIN, data=lat3)
summary(A1.DbL.L)

ggplot(lat3, aes(x=factor(BASIN), y=abs.res.DbL)) +
  geom_boxplot()

A1.HL.L <- aov(abs.res.HL ~ BASIN, data=lat3)
summary(A1.HL.L)

ggplot(lat3, aes(x=factor(BASIN), y=abs.res.HL)) +
  geom_boxplot()

A1.HD.L <- aov(abs.res.HD ~ BASIN, data=lat3)
summary(A1.HD.L)

ggplot(lat3, aes(x=factor(BASIN), y=abs.res.HD)) +
  geom_boxplot()

A1.HW.L <- aov(abs.res.HW ~ BASIN, data=lat3)
summary(A1.HW.L)

ggplot(lat3, aes(x=factor(BASIN), y=abs.res.HW)) +
  geom_boxplot()

A1.SnL.L <- aov(abs.res.SnL ~ BASIN, data=lat3)
summary(A1.SnL.L)

A1.OL.L <- aov(abs.res.OL ~ BASIN, data=lat3)
summary(A1.OL.L)

ggplot(lat3, aes(x=factor(BASIN), y=abs.res.OL)) +
  geom_boxplot()




```

##### Watersheds 

```{r}

A2.D.L <- aov(abs.res.D ~ WATERSHED, data=lat3)
summary(A2.D.L)

ggplot(lat3, aes(x=factor(WATERSHED), y=abs.res.D)) +
  geom_boxplot()

A2.P1.L <- aov(abs.res.P1 ~ WATERSHED, data=lat3)
summary(A2.P1.L)

A2.P1.R.L <- aov(abs.res.P1.R ~ WATERSHED, data=lat3)
summary(A2.P1.R.L)

ggplot(lat3, aes(x=factor(WATERSHED), y=abs.res.P1.R)) +
  geom_boxplot()

A2.LLSC.L <- aov(abs.res.LLSC ~ WATERSHED, data=lat3)
summary(A2.LLSC.L)

ggplot(lat3, aes(x=factor(WATERSHED), y=abs.res.LLSC)) +
  geom_boxplot()



A2.SBLL.L <- aov(abs.res.SBLL ~ WATERSHED, data=lat3)
summary(A2.SBLL.L)

ggplot(lat3, aes(x=factor(WATERSHED), y=abs.res.SBLL)) +
  geom_boxplot()

A2.BD.L <- aov(abs.res.BD ~ WATERSHED, data=lat3)
summary(A2.BD.L)

ggplot(lat3, aes(x=factor(WATERSHED), y=abs.res.BD)) +
  geom_boxplot()

A2.CPD.L <- aov(abs.res.CPD ~ WATERSHED, data=lat3)
summary(A2.CPD.L)

ggplot(lat3, aes(x=factor(WATERSHED), y=abs.res.CPD)) +
  geom_boxplot()

A2.CPL.L <- aov(abs.res.CPL ~ WATERSHED, data=lat3)
summary(A2.CPL.L)

A2.PreDL.L <- aov(abs.res.PreDL ~ WATERSHED, data=lat3)
summary(A2.PreDL.L)

A2.DbL.L <- aov(abs.res.DbL ~ WATERSHED, data=lat3)
summary(A2.DbL.L)

ggplot(lat3, aes(x=factor(WATERSHED), y=abs.res.DbL)) +
  geom_boxplot()

A2.HL.L <- aov(abs.res.HL ~ WATERSHED, data=lat3)
summary(A2.HL.L)

ggplot(lat3, aes(x=factor(WATERSHED), y=abs.res.HL)) +
  geom_boxplot()

A2.HD.L <- aov(abs.res.HD ~ WATERSHED, data=lat3)
summary(A2.HD.L)

ggplot(lat3, aes(x=factor(WATERSHED), y=abs.res.HD)) +
  geom_boxplot()

A2.HW.L <- aov(abs.res.HW ~ WATERSHED, data=lat3)
summary(A2.HW.L)

ggplot(lat3, aes(x=factor(WATERSHED), y=abs.res.HW)) +
  geom_boxplot()

A2.SnL.L <- aov(abs.res.SnL ~ WATERSHED, data=lat3)
summary(A2.SnL.L)

A2.OL.L <- aov(abs.res.OL ~ WATERSHED, data=lat3)
summary(A2.OL.L)

ggplot(lat3, aes(x=factor(WATERSHED), y=abs.res.OL)) +
  geom_boxplot()




```

#### Both

##### Zones 

```{r}
library(ggplot2)

A.D <- aov(abs.res.D ~ SPP*QUARTILE, data=raw3)
summary(A.D)

ggplot(raw3, aes(x=factor(QUARTILE), y=abs.res.D, fill=SPP)) +
  geom_boxplot()


A.P1.L <- aov(abs.res.P1 ~ SPP*QUARTILE, data=raw3)
summary(A.P1.L)

A.P1.R <- aov(abs.res.P1.R ~ SPP*QUARTILE, data=raw3)
summary(A.P1.R)

ggplot(raw3, aes(x=factor(QUARTILE), y=abs.res.P1.R, fill=SPP)) +
  geom_boxplot()


A.LLSC <- aov(abs.res.LLSC ~ SPP*QUARTILE, data=raw3)
summary(A.LLSC)


A.SBLL <- aov(abs.res.SBLL ~ SPP*QUARTILE, data=raw3)
summary(A.SBLL)

ggplot(raw3, aes(x=factor(QUARTILE), y=abs.res.SBLL, fill=SPP)) +
  geom_boxplot()


A.BD <- aov(abs.res.BD ~ SPP*QUARTILE, data=raw3)
summary(A.BD)

ggplot(raw3, aes(x=factor(QUARTILE), y=abs.res.BD, fill=SPP)) +
  geom_boxplot()


A.CPD <- aov(abs.res.CPD ~ SPP*QUARTILE, data=raw3)
summary(A.CPD)

ggplot(raw3, aes(x=factor(QUARTILE), y=abs.res.CPD, fill=SPP)) +
  geom_boxplot()


A.CPL <- aov(abs.res.CPL ~ SPP*QUARTILE, data=raw3)
summary(A.CPL)

ggplot(raw3, aes(x=factor(QUARTILE), y=abs.res.CPL, fill=SPP)) +
  geom_boxplot()


A.PreDL <- aov(abs.res.PreDL ~ SPP*QUARTILE, data=raw3)
summary(A.PreDL)

ggplot(raw3, aes(x=factor(QUARTILE), y=abs.res.PreDL, fill=SPP)) +
  geom_boxplot()


A.DbL <- aov(abs.res.DbL ~ SPP*QUARTILE, data=raw3)
summary(A.DbL)

ggplot(raw3, aes(x=factor(QUARTILE), y=abs.res.DbL, fill=SPP)) +
  geom_boxplot()


A.HL <- aov(abs.res.HL ~ SPP*QUARTILE, data=raw3)
summary(A.HL)

ggplot(raw3, aes(x=factor(QUARTILE), y=abs.res.HL, fill=SPP)) +
  geom_boxplot()


A.HD <- aov(abs.res.HD ~ SPP*QUARTILE, data=raw3)
summary(A.HD)

A.HW <- aov(abs.res.HW ~ SPP*QUARTILE, data=raw3)
summary(A.HW)

ggplot(raw3, aes(x=factor(QUARTILE), y=abs.res.HW, fill=SPP)) +
  geom_boxplot()


A.SnL <- aov(abs.res.SnL ~ SPP*QUARTILE, data=raw3)
summary(A.SnL)

A.OL <- aov(abs.res.OL ~ SPP*QUARTILE, data=raw3)
summary(A.OL)

ggplot(raw3, aes(x=factor(QUARTILE), y=abs.res.OL, fill=SPP)) +
  geom_boxplot()


```

##### Basins 

```{r}

A1.D <- aov(abs.res.D ~ SPP*BASIN, data=raw3)
summary(A1.D)

ggplot(raw3, aes(x=factor(BASIN), y=abs.res.D, fill=SPP)) +
  geom_boxplot()


A1.P1 <- aov(abs.res.P1 ~ SPP*BASIN, data=raw3)
summary(A1.P1)

A1.P1.R <- aov(abs.res.P1.R ~ SPP*BASIN, data=raw3)
summary(A1.P1.R)

ggplot(raw3, aes(x=factor(BASIN), y=abs.res.P1.R, fill=SPP)) +
  geom_boxplot()

A1.LLSC <- aov(abs.res.LLSC ~ SPP*BASIN, data=raw3)
summary(A1.LLSC)

ggplot(raw3, aes(x=factor(BASIN), y=abs.res.LLSC, fill=SPP)) +
  geom_boxplot()



A1.SBLL <- aov(abs.res.SBLL ~ SPP*BASIN, data=raw3)
summary(A1.SBLL)

ggplot(raw3, aes(x=factor(BASIN), y=abs.res.SBLL, fill=SPP)) +
  geom_boxplot()

A1.BD <- aov(abs.res.BD ~ SPP*BASIN, data=raw3)
summary(A1.BD)

ggplot(raw3, aes(x=factor(BASIN), y=abs.res.BD, fill=SPP)) +
  geom_boxplot()

A1.CPD <- aov(abs.res.CPD ~ SPP*BASIN, data=raw3)
summary(A1.CPD)

ggplot(raw3, aes(x=factor(BASIN), y=abs.res.CPD, fill=SPP)) +
  geom_boxplot()

A1.CPL <- aov(abs.res.CPL ~ SPP*BASIN, data=raw3)
summary(A1.CPL)

A1.PreDL <- aov(abs.res.PreDL ~ SPP*BASIN, data=raw3)
summary(A1.PreDL)

ggplot(raw3, aes(x=factor(BASIN), y=abs.res.PreDL, fill=SPP)) +
  geom_boxplot()

A1.DbL <- aov(abs.res.DbL ~ SPP*BASIN, data=raw3)
summary(A1.DbL)

ggplot(raw3, aes(x=factor(BASIN), y=abs.res.DbL, fill=SPP)) +
  geom_boxplot()

A1.HL <- aov(abs.res.HL ~ SPP*BASIN, data=raw3)
summary(A1.HL)

ggplot(raw3, aes(x=factor(BASIN), y=abs.res.HL, fill=SPP)) +
  geom_boxplot()

A1.HD <- aov(abs.res.HD ~ SPP*BASIN, data=raw3)
summary(A1.HD)

ggplot(raw3, aes(x=factor(BASIN), y=abs.res.HD, fill=SPP)) +
  geom_boxplot()

A1.HW <- aov(abs.res.HW ~ SPP*BASIN, data=raw3)
summary(A1.HW)

ggplot(raw3, aes(x=factor(BASIN), y=abs.res.HW, fill=SPP)) +
  geom_boxplot()

A1.SnL <- aov(abs.res.SnL ~ SPP*BASIN, data=raw3)
summary(A1.SnL)

A1.OL <- aov(abs.res.OL ~ SPP*BASIN, data=raw3)
summary(A1.OL)

ggplot(raw3, aes(x=factor(BASIN), y=abs.res.OL, fill=SPP)) +
  geom_boxplot()




```

##### Watersheds 

```{r}

A2.D <- aov(abs.res.D ~ SPP*WATERSHED, data=raw3)
summary(A2.D)

ggplot(raw3, aes(x=factor(WATERSHED), y=abs.res.D, fill=SPP)) +
  geom_boxplot()

A2.P1 <- aov(abs.res.P1 ~ SPP*WATERSHED, data=raw3)
summary(A2.P1)

A2.P1.R <- aov(abs.res.P1.R ~ SPP*WATERSHED, data=raw3)
summary(A2.P1.R)

ggplot(raw3, aes(x=factor(WATERSHED), y=abs.res.P1.R, fill=SPP)) +
  geom_boxplot()

A2.LLSC <- aov(abs.res.LLSC ~ SPP*WATERSHED, data=raw3)
summary(A2.LLSC)

ggplot(raw3, aes(x=factor(WATERSHED), y=abs.res.LLSC, fill=SPP)) +
  geom_boxplot()



A2.SBLL <- aov(abs.res.SBLL ~ SPP*WATERSHED, data=raw3)
summary(A2.SBLL)

ggplot(raw3, aes(x=factor(WATERSHED), y=abs.res.SBLL, fill=SPP)) +
  geom_boxplot()

A2.BD <- aov(abs.res.BD ~ SPP*WATERSHED, data=raw3)
summary(A2.BD)

ggplot(raw3, aes(x=factor(WATERSHED), y=abs.res.BD, fill=SPP)) +
  geom_boxplot()

A2.CPD <- aov(abs.res.CPD ~ SPP*WATERSHED, data=raw3)
summary(A2.CPD)

ggplot(raw3, aes(x=factor(WATERSHED), y=abs.res.CPD, fill=SPP)) +
  geom_boxplot()

A2.CPL <- aov(abs.res.CPL ~ SPP*WATERSHED, data=raw3)
summary(A2.CPL)

A2.PreDL <- aov(abs.res.PreDL ~ SPP*WATERSHED, data=raw3)
summary(A2.PreDL)

A2.DbL <- aov(abs.res.DbL ~ SPP*WATERSHED, data=raw3)
summary(A2.DbL)

ggplot(raw3, aes(x=factor(WATERSHED), y=abs.res.DbL, fill=SPP)) +
  geom_boxplot()

A2.HL <- aov(abs.res.HL ~ SPP*WATERSHED, data=raw3)
summary(A2.HL)

ggplot(raw3, aes(x=factor(WATERSHED), y=abs.res.HL, fill=SPP)) +
  geom_boxplot()

A2.HD <- aov(abs.res.HD ~ SPP*WATERSHED, data=raw3)
summary(A2.HD)

ggplot(raw3, aes(x=factor(WATERSHED), y=abs.res.HD, fill=SPP)) +
  geom_boxplot()

A2.HW <- aov(abs.res.HW ~ SPP*WATERSHED, data=raw3)
summary(A2.HW)

ggplot(raw3, aes(x=factor(WATERSHED), y=abs.res.HW, fill=SPP)) +
  geom_boxplot()

A2.SnL <- aov(abs.res.SnL ~ SPP*WATERSHED, data=raw3)
summary(A2.SnL)

A2.OL <- aov(abs.res.OL ~ SPP*WATERSHED, data=raw3)
summary(A2.OL)

ggplot(raw3, aes(x=factor(WATERSHED), y=abs.res.OL, fill=SPP)) +
  geom_boxplot()




```

#### Standardized

DON'T KNOW IF THIS IS USEFUL

The ANOVAs above focus on differences of particular traits as a factor of species and location. If we want to get an idea of variation in general as a factor of species and location, we can standardize the residuals (essentially unitless z-scores of residuals).

```{r}

sd.res.D <- append(abs(sd.lat.D), abs(sd.form.D))
sd.res.P1 <- append(abs(sd.lat.P1), abs(sd.form.P1))
sd.res.P1.R <- append(abs(sd.lat.P1.R), abs(sd.form.P1.R))
sd.res.LLSC<- append(abs(sd.lat.LLSC), abs(sd.form.LLSC))
sd.res.SBLL<- append(abs(sd.lat.SBLL), abs(sd.form.SBLL))
sd.res.BD<- append(abs(sd.lat.BD), abs(sd.form.BD))
sd.res.CPD<- append(abs(sd.lat.CPD), abs(sd.form.CPD))
sd.res.CPL<- append(abs(sd.lat.CPL), abs(sd.form.CPL))
sd.res.PreDL <- append(abs(sd.lat.PreDL), abs(sd.form.PreDL))
sd.res.DbL <- append(abs(sd.lat.DbL), abs(sd.form.DbL))
sd.res.HL<- append(abs(sd.lat.HL), abs(sd.form.HL))
sd.res.HD<- append(abs(sd.lat.HD), abs(sd.form.HD))
sd.res.HW <- append(abs(sd.lat.HW), abs(sd.form.HW))
sd.res.SnL <- append(abs(sd.lat.SnL), abs(sd.form.SnL))
sd.res.OL <- append(abs(sd.lat.OL), abs(sd.form.OL))


raw4 <- cbind(raw3, sd.res.D, sd.res.P1, sd.res.P1.R, sd.res.LLSC, sd.res.SBLL, sd.res.BD, sd.res.CPD, sd.res.CPL, sd.res.PreDL, sd.res.DbL, sd.res.HL, sd.res.HD, sd.res.HW, sd.res.SnL, sd.res.OL)

raw5 <- cbind(raw4[1:14], stack(raw4[53:68])) 

lat.raw5 <- raw5[raw5$SPP == "p.latipinna",]

form.raw5 <- raw5[raw5$SPP == "p.formosa",]

######ZONES#####

A3.lat <- aov(values~QUARTILE, data=lat.raw5)
summary(A3.lat)

A3.form <- aov(values~QUARTILE, data=form.raw5)
summary(A3.form)

#between species

A3 <- aov(values~QUARTILE*SPP, data=raw5)
summary(A3)

ggplot(raw5, aes(x=factor(QUARTILE), y=values, fill=SPP)) +
  geom_boxplot()

######BASINS#####

A4.lat <- aov(values~BASIN, data=lat.raw5)
summary(A4.lat)

A4.form <- aov(values~BASIN, data=form.raw5)
summary(A4.form)

#between species

A4 <- aov(values~BASIN*SPP, data=raw5)
summary(A4)

ggplot(raw5, aes(x=factor(BASIN), y=values, fill=SPP)) +
  geom_boxplot()

#####WATERSHEDS#####
A5.lat <- aov(values~WATERSHED, data=lat.raw5)
summary(A5.lat)

A5.form <- aov(values~WATERSHED, data=form.raw5)
summary(A5.form)

#between species

A5 <- aov(values~WATERSHED*SPP, data=raw5)
summary(A5)

ggplot(raw5, aes(x=factor(WATERSHED), y=values, fill=SPP)) +
  geom_boxplot()



```



### GLMMs

Will run mixed models with zones/basins/watersheds as random effect. This will account for any variation seen at these levels and show us if there are any consistent species differences. Can only do this with residuals. 

#### Zones

```{r}
library(lme4)
library(lmerTest)


MM.D <- glmer(abs.res.D ~ SPP + (1|QUARTILE), data=raw3)#originally had family=poisson, since this is count data, but because this was the residuals of count data, the values were non-integers and poisson only deals with integers. 
MM.D.a <- anova(MM.D, test="Chisq")
summary(MM.D.a)

MM.P1 <- glmer(abs.res.P1 ~ SPP+ (1|QUARTILE), data=raw3)
MM.P1.a <- anova(MM.P1, test="Chisq")
summary(MM.P1.a)

MM.P1.R <- glmer(abs.res.P1.R ~ SPP+ (1|QUARTILE), data=raw3)
MM.P1.Ra <- anova(MM.P1.R, test="Chisq")
summary(MM.P1.Ra)

MM.LLSC <- glmer(abs.res.LLSC ~ SPP+ (1|QUARTILE), data=raw3)
MM.LLSC.a <- anova(MM.LLSC, test="Chisq")
summary(MM.LLSC.a)


MM.SBLL <- glmer(abs.res.SBLL ~ SPP+ (1|QUARTILE), data=raw3)
MM.SBLL.a <- anova(MM.SBLL, test="Chisq")
summary(MM.SBLL.a)


MM.BD <- glmer(abs.res.BD ~ SPP+ (1|QUARTILE), data=raw3)
MM.BD.a <- anova(MM.BD, test="Chisq")
summary(MM.BD.a)


MM.CPD <- glmer(abs.res.CPD ~ SPP+ (1|QUARTILE), data=raw3)
MM.CPD.a <- anova(MM.CPD, test="Chisq")
summary(MM.CPD.a)


MM.CPL <- glmer(abs.res.CPL ~ SPP+ (1|QUARTILE), data=raw3)
MM.CPL.a <- anova(MM.CPL, test="Chisq")
summary(MM.CPL.a)

MM.PreDL <- glmer(abs.res.PreDL ~ SPP+ (1|QUARTILE), data=raw3)
MM.PreDL.a <- anova(MM.PreDL, test="Chisq")
summary(MM.PreDL.a)

MM.DbL <- glmer(abs.res.DbL ~ SPP+ (1|QUARTILE), data=raw3)
MM.DbL.a <- anova(MM.DbL, test="Chisq")
summary(MM.DbL.a)

MM.HL <- glmer(abs.res.HL ~ SPP+ (1|QUARTILE), data=raw3)
MM.HL.a <- anova(MM.HL, test="Chisq")
summary(MM.HL.a)

MM.HD <- glmer(abs.res.HD ~ SPP+ (1|QUARTILE), data=raw3)
MM.HD.a <- anova(MM.HD, test="Chisq")
summary(MM.HD.a)

MM.HW <- glmer(abs.res.HW ~ SPP+ (1|QUARTILE), data=raw3)
MM.HW.a <- anova(MM.HW, test="Chisq")
summary(MM.HW.a)

MM.SnL <- glmer(abs.res.SnL ~ SPP+ (1|QUARTILE), data=raw3)
MM.SnL.a <- anova(MM.SnL, test="Chisq")
summary(MM.SnL.a)

MM.OL <- glmer(abs.res.OL ~ SPP+ (1|QUARTILE), data=raw3)
MM.OL.a <- anova(MM.OL, test="Chisq")
summary(MM.OL.a)



```



#### Watershed nested in Basin

```{r}

MM1.D <- glmer(abs.res.D ~ SPP + (1|BASIN/WATERSHED), data=raw3)
MM1.D.a <- anova(MM1.D, test="Chisq")
summary(MM1.D.a)

MM1.P1 <- glmer(abs.res.P1 ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.P1.a <- anova(MM1.P1, test="Chisq")
summary(MM1.P1.a)

MM1.P1.R <- glmer(abs.res.P1.R ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.P1.Ra <- anova(MM1.P1.R, test="Chisq")
summary(MM1.P1.Ra)

MM1.LLSC <- glmer(abs.res.LLSC ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.LLSC.a <- anova(MM1.LLSC, test="Chisq")
summary(MM1.LLSC.a)

MM1.SBLL <- glmer(abs.res.SBLL ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.SBLL.a <- anova(MM1.SBLL, test="Chisq")
summary(MM1.SBLL.a)

MM1.BD <- glmer(abs.res.BD ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.BD.a <- anova(MM1.BD, test="Chisq")
summary(MM1.BD.a)

MM1.CPD <- glmer(abs.res.CPD ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.CPD.a <- anova(MM1.CPD, test="Chisq")
summary(MM1.CPD.a)

MM1.CPL <- glmer(abs.res.CPL ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.CPL.a <- anova(MM1.CPL, test="Chisq")
summary(MM1.CPL.a)

MM1.PreDL <- glmer(abs.res.PreDL ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.PreDL.a <- anova(MM1.PreDL, test="Chisq")
summary(MM1.PreDL.a)

MM1.DbL <- glmer(abs.res.DbL ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.DbL.a <- anova(MM1.DbL, test="Chisq")
summary(MM1.DbL.a)

MM1.HL <- glmer(abs.res.HL ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.HL.a <- anova(MM1.HL, test="Chisq")
summary(MM1.HL.a)

MM1.HD <- glmer(abs.res.HD ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.HD.a <- anova(MM1.HD, test="Chisq")
summary(MM1.HD.a)

MM1.HW <- glmer(abs.res.HW ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.HW.a <- anova(MM1.HW, test="Chisq")
summary(MM1.HW.a)

MM1.SnL <- glmer(abs.res.SnL ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.SnL.a <- anova(MM1.SnL, test="Chisq")
summary(MM1.SnL.a)

MM1.OL <- glmer(abs.res.OL ~ SPP+ (1|BASIN/WATERSHED), data=raw3)
MM1.OL.a <- anova(MM1.OL, test="Chisq")
summary(MM1.OL.a)


```


***

### Levene's w/ Basin?

Not sure if this is correct, but might try Levene's test with zone/basin/watershed as an additional independent factor? This is for the traits that did NOT vary with body length.


#### Zones

```{r}
library(car)

(LT2_P2L <- leveneTest(P2.L~SPP*QUARTILE, data=raw3)) #gives nothing since it's all the same value

(LT2_P2R <- leveneTest(P2.R~SPP*QUARTILE, data=raw3)) #same as above

(LT2_A <- leveneTest(A~SPP*QUARTILE, data=raw3)) 

(LT2_SALL <- leveneTest(SALL~SPP*QUARTILE, data=raw3))

(LT2_SBLL <- leveneTest(SBLL~SPP*QUARTILE, data=raw3))

(LT2_SBDF <- leveneTest(SBDF~SPP*QUARTILE, data=raw3))

(LT2_FLA <- leveneTest(FLA~SPP*QUARTILE, data=raw3))

```

#### Basins

```{r}
(LT2_P2L <- leveneTest(P2.L~SPP*BASIN, data=raw3)) #gives nothing since it's all the same value

(LT2_P2R <- leveneTest(P2.R~SPP*BASIN, data=raw3)) #same as above

(LT2_A <- leveneTest(A~SPP*BASIN, data=raw3)) 

(LT2_SALL <- leveneTest(SALL~SPP*BASIN, data=raw3))

(LT2_SBLL <- leveneTest(SBLL~SPP*BASIN, data=raw3))

(LT2_SBDF <- leveneTest(SBDF~SPP*BASIN, data=raw3))

(LT2_FLA <- leveneTest(FLA~SPP*BASIN, data=raw3))

```


#### Watersheds

```{r}
(LT2_P2L <- leveneTest(P2.L~SPP*WATERSHED, data=raw3)) #gives nothing since it's all the same value

(LT2_P2R <- leveneTest(P2.R~SPP*WATERSHED, data=raw3)) #same as above

(LT2_A <- leveneTest(A~SPP*WATERSHED, data=raw3)) 

(LT2_SALL <- leveneTest(SALL~SPP*WATERSHED, data=raw3))

(LT2_SBLL <- leveneTest(SBLL~SPP*WATERSHED, data=raw3))

(LT2_SBDF <- leveneTest(SBDF~SPP*WATERSHED, data=raw3))

(LT2_FLA <- leveneTest(FLA~SPP*WATERSHED, data=raw3))

```


***




# Filtered data

Now I will repeat analysis on a dataset that filters for fish above 32.5mm (this is the average for the range I found in literature, 28-37mm). This would confirm that all fish are likely adults, and remove any bias from juvenile proportions (ex. if juvenile head is proportionately larger than expected for body).

## Initial steps 

Data collection 

```{r, echo=FALSE}

library(dplyr)

rawF <- filter(raw1,SL>=32.5)

rawF1 <- rawF[-c(150), ] #this takes out the monster fish too




library(ggplot2)
library(ggpubr)



lat.F <- rawF[rawF$SPP == "p.latipinna",]


form.F <- rawF[rawF$SPP == "p.formosa",]


mex.F <- rawF[rawF$SPP == "p.mexicana",]



##### LAT #####
F.reg.lat.D <- lm(lat.F$D ~ lat.F$SL)
F.sd.lat.D <- rstandard(F.reg.lat.D)


F.reg.lat.P1 <- lm(lat.F$P1 ~ lat.F$SL)
F.sd.lat.P1 <- rstandard(F.reg.lat.P1)


F.reg.lat.P2.L <- lm(lat.F$P2.L ~ lat.F$SL)
F.sd.lat.P2.L <- rstandard(F.reg.lat.P2.L)


F.reg.lat.P2.R <- lm(lat.F$P2.R ~ lat.F$SL)
F.sd.lat.P2.R <- rstandard(F.reg.lat.P2.R)


F.reg.lat.A <- lm(lat.F$A ~ lat.F$SL)
F.sd.lat.A <- rstandard(F.reg.lat.A)

F.reg.lat.P1.R <- lm(lat.F$P1.R ~ lat.F$SL)
F.sd.lat.P1.R <- rstandard(F.reg.lat.P1.R)


F.reg.lat.LLSC <- lm(lat.F$LLSC ~ lat.F$SL)
F.sd.lat.LLSC <- rstandard(F.reg.lat.LLSC)


F.reg.lat.SALL <- lm(lat.F$SALL ~ lat.F$SL)
F.sd.lat.SALL <- rstandard(F.reg.lat.SALL)


F.reg.lat.SBLL <- lm(lat.F$SBLL ~ lat.F$SL)
F.sd.lat.SBLL <- rstandard(F.reg.lat.SBLL)


F.reg.lat.SBDF <- lm(lat.F$SBDF ~ lat.F$SL)
F.sd.lat.SBDF <- rstandard(F.reg.lat.SBDF)


F.reg.lat.BD <- lm(lat.F$BD_log ~ lat.F$SL_log)
F.sd.lat.BD <- rstandard(F.reg.lat.BD)


F.reg.lat.CPD <- lm(lat.F$CPD_log ~ lat.F$SL_log)
F.sd.lat.CPD <- rstandard(F.reg.lat.CPD)


F.reg.lat.CPL <- lm(lat.F$CPL_log ~ lat.F$SL_log)
F.sd.lat.CPL <- rstandard(F.reg.lat.CPL)


F.reg.lat.PreDL <- lm(lat.F$PreDL_log ~ lat.F$SL_log)
F.sd.lat.PreDL <- rstandard(F.reg.lat.PreDL)


F.reg.lat.DbL <- lm(lat.F$DbL_log ~ lat.F$SL_log)
F.sd.lat.DbL <- rstandard(F.reg.lat.DbL)


F.reg.lat.HL <- lm(lat.F$HL_log ~ lat.F$SL_log)
F.sd.lat.HL <- rstandard(F.reg.lat.HL)


F.reg.lat.HD <- lm(lat.F$HD_log ~ lat.F$SL_log)
F.sd.lat.HD <- rstandard(F.reg.lat.HD)


F.reg.lat.HW <- lm(lat.F$HW_log ~ lat.F$SL_log)
F.sd.lat.HW <- rstandard(F.reg.lat.HW)


F.reg.lat.SnL <- lm(lat.F$SnL_log ~ lat.F$SL_log)
F.sd.lat.SnL <- rstandard(F.reg.lat.SnL)


F.reg.lat.OL <- lm(lat.F$OL_log ~ lat.F$SL_log)
F.sd.lat.OL <- rstandard(F.reg.lat.OL)


F.reg.lat.FLA <- lm(lat.F$FLA ~ lat.F$SL)
F.sd.lat.FLA <- rstandard(F.reg.lat.FLA)

##### FORM #####

F.reg.form.D <- lm(form.F$D ~ form.F$SL)
F.sd.form.D <- rstandard(F.reg.form.D)


F.reg.form.P1 <- lm(form.F$P1 ~ form.F$SL)
F.sd.form.P1 <- rstandard(F.reg.form.P1)


F.reg.form.P2.L <- lm(form.F$P2.L ~ form.F$SL)
F.sd.form.P2.L <- rstandard(F.reg.form.P2.L)


F.reg.form.P2.R <- lm(form.F$P2.R ~ form.F$SL)
F.sd.form.P2.R <- rstandard(F.reg.form.P2.R)


F.reg.form.A <- lm(form.F$A ~ form.F$SL)
F.sd.form.A <- rstandard(F.reg.form.A)

F.reg.form.P1.R <- lm(form.F$P1.R ~ form.F$SL)
F.sd.form.P1.R <- rstandard(F.reg.form.P1.R)


F.reg.form.LLSC <- lm(form.F$LLSC ~ form.F$SL)
F.sd.form.LLSC <- rstandard(F.reg.form.LLSC)


F.reg.form.SALL <- lm(form.F$SALL ~ form.F$SL)
F.sd.form.SALL <- rstandard(F.reg.form.SALL)


F.reg.form.SBLL <- lm(form.F$SBLL ~ form.F$SL)
F.sd.form.SBLL <- rstandard(F.reg.form.SBLL)


F.reg.form.SBDF <- lm(form.F$SBDF ~ form.F$SL)
F.sd.form.SBDF <- rstandard(F.reg.form.SBDF)


F.reg.form.BD <- lm(form.F$BD_log ~ form.F$SL_log)
F.sd.form.BD <- rstandard(F.reg.form.BD)


F.reg.form.CPD <- lm(form.F$CPD_log ~ form.F$SL_log)
F.sd.form.CPD <- rstandard(F.reg.form.CPD)


F.reg.form.CPL <- lm(form.F$CPL_log ~ form.F$SL_log)
F.sd.form.CPL <- rstandard(F.reg.form.CPL)


F.reg.form.PreDL <- lm(form.F$PreDL_log ~ form.F$SL_log)
F.sd.form.PreDL <- rstandard(F.reg.form.PreDL)


F.reg.form.DbL <- lm(form.F$DbL_log ~ form.F$SL_log)
F.sd.form.DbL <- rstandard(F.reg.form.DbL)


F.reg.form.HL <- lm(form.F$HL_log ~ form.F$SL_log)
F.sd.form.HL <- rstandard(F.reg.form.HL)


F.reg.form.HD <- lm(form.F$HD_log ~ form.F$SL_log)
F.sd.form.HD <- rstandard(F.reg.form.HD)


F.reg.form.HW <- lm(form.F$HW_log ~ form.F$SL_log)
F.sd.form.HW <- rstandard(F.reg.form.HW)


F.reg.form.SnL <- lm(form.F$SnL_log ~ form.F$SL_log)
F.sd.form.SnL <- rstandard(F.reg.form.SnL)


F.reg.form.OL <- lm(form.F$OL_log ~ form.F$SL_log)
F.sd.form.OL <- rstandard(F.reg.form.OL)


F.reg.form.FLA <- lm(form.F$FLA ~ form.F$SL)
F.sd.form.FLA <- rstandard(F.reg.form.FLA)




##### MEX #####
F.reg.mex.D <- lm(mex.F$D ~ mex.F$SL)
F.sd.mex.D <- rstandard(F.reg.mex.D)


F.reg.mex.P1 <- lm(mex.F$P1 ~ mex.F$SL)
F.sd.mex.P1 <- rstandard(F.reg.mex.P1)


F.reg.mex.P2.L <- lm(mex.F$P2.L ~ mex.F$SL)
F.sd.mex.P2.L <- rstandard(F.reg.mex.P2.L)


F.reg.mex.P2.R <- lm(mex.F$P2.R ~ mex.F$SL)
F.sd.mex.P2.R <- rstandard(F.reg.mex.P2.R)


F.reg.mex.A <- lm(mex.F$A ~ mex.F$SL)
F.sd.mex.A <- rstandard(F.reg.mex.A)


F.reg.mex.P1.R <- lm(mex.F$P1.R ~ mex.F$SL)
F.sd.mex.P1.R <- rstandard(F.reg.mex.P1.R)


F.reg.mex.LLSC <- lm(mex.F$LLSC ~ mex.F$SL)
F.sd.mex.LLSC <- rstandard(F.reg.mex.LLSC)


F.reg.mex.SALL <- lm(mex.F$SALL ~ mex.F$SL)
F.sd.mex.SALL <- rstandard(F.reg.mex.SALL)


F.reg.mex.SBLL <- lm(mex.F$SBLL ~ mex.F$SL)
F.sd.mex.SBLL <- rstandard(F.reg.mex.SBLL)


F.reg.mex.SBDF <- lm(mex.F$SBDF ~ mex.F$SL)
F.sd.mex.SBDF <- rstandard(F.reg.mex.SBDF)


F.reg.mex.BD <- lm(mex.F$BD_log ~ mex.F$SL_log)
F.sd.mex.BD <- rstandard(F.reg.mex.BD)


F.reg.mex.CPD <- lm(mex.F$CPD_log ~ mex.F$SL_log)
F.sd.mex.CPD <- rstandard(F.reg.mex.CPD)

F.reg.mex.CPL <- lm(mex.F$CPL_log ~ mex.F$SL_log)
F.sd.mex.CPL <- rstandard(F.reg.mex.CPL)


F.reg.mex.PreDL <- lm(mex.F$PreDL_log ~ mex.F$SL_log)
F.sd.mex.PreDL <- rstandard(F.reg.mex.PreDL)

F.reg.mex.DbL <- lm(mex.F$DbL_log ~ mex.F$SL_log)
F.sd.mex.DbL <- rstandard(F.reg.mex.DbL)


F.reg.mex.HL <- lm(mex.F$HL_log ~ mex.F$SL_log)
F.sd.mex.HL <- rstandard(F.reg.mex.HL)


F.reg.mex.HD <- lm(mex.F$HD_log ~ mex.F$SL_log)
F.sd.mex.HD <- rstandard(F.reg.mex.HD)


F.reg.mex.HW <- lm(mex.F$HW_log ~ mex.F$SL_log)
F.sd.mex.HW <- rstandard(F.reg.mex.HW)


F.reg.mex.SnL <- lm(mex.F$SnL_log ~ mex.F$SL_log)
F.sd.mex.SnL <- rstandard(F.reg.mex.SnL)


F.reg.mex.OL <- lm(mex.F$OL_log ~ mex.F$SL_log)
F.sd.mex.OL <- rstandard(F.reg.mex.OL)


F.reg.mex.FLA <- lm(mex.F$FLA ~ mex.F$SL)
F.sd.mex.FLA <- rstandard(F.reg.mex.FLA)



##### LAT #####
F.res.lat.D <- resid(F.reg.lat.D)

F.res.lat.P1.R <- resid(F.reg.lat.P1.R)

F.res.lat.LLSC <- resid(F.reg.lat.LLSC)

F.res.lat.SBLL <- resid(F.reg.lat.SBLL) 

F.res.lat.BD <- resid(F.reg.lat.BD)

F.res.lat.CPD <- resid(F.reg.lat.CPD)

F.res.lat.CPL <- resid(F.reg.lat.CPL)

F.res.lat.PreDL <- resid(F.reg.lat.PreDL)

F.res.lat.DbL <- resid(F.reg.lat.DbL)

F.res.lat.HL <- resid(F.reg.lat.HL)

F.res.lat.HD <- resid(F.reg.lat.HD)

F.res.lat.HW <- resid(F.reg.lat.HW)

F.res.lat.SnL <- resid(F.reg.lat.SnL)

F.res.lat.OL <- resid(F.reg.lat.OL)

##### FORM #####

F.res.form.D <- resid(F.reg.form.D)

F.res.form.P1.R <- resid(F.reg.form.P1.R)

F.res.form.LLSC <- resid(F.reg.form.LLSC)

F.res.form.SBLL <- resid(F.reg.form.SBLL)

F.res.form.BD <- resid(F.reg.form.BD)

F.res.form.CPD <- resid(F.reg.form.CPD)

F.res.form.CPL <- resid(F.reg.form.CPL)

F.res.form.PreDL <- resid(F.reg.form.PreDL)

F.res.form.DbL <- resid(F.reg.form.DbL)

F.res.form.HL <- resid(F.reg.form.HL)

F.res.form.HD <- resid(F.reg.form.HD)

F.res.form.HW <- resid(F.reg.form.HW)

F.res.form.SnL <- resid(F.reg.form.SnL)

F.res.form.OL <- resid(F.reg.form.OL)


##### MEX #####
F.res.mex.D <- resid(F.reg.mex.D)

F.res.mex.P1.R <- resid(F.reg.mex.P1.R)

F.res.mex.LLSC <- resid(F.reg.mex.LLSC)

F.res.mex.SBLL <- resid(F.reg.mex.SBLL)

F.res.mex.BD <- resid(F.reg.mex.BD)

F.res.mex.CPD <- resid(F.reg.mex.CPD)

F.res.mex.CPL <- resid(F.reg.mex.CPL)

F.res.mex.PreDL <- resid(F.reg.mex.PreDL)

F.res.mex.DbL <- resid(F.reg.mex.DbL)

F.res.mex.HL <- resid(F.reg.mex.HL)

F.res.mex.HD <- resid(F.reg.mex.HD)

F.res.mex.HW <- resid(F.reg.mex.HW)

F.res.mex.SnL <- resid(F.reg.mex.SnL)

F.res.mex.OL <- resid(F.reg.mex.OL)


##### LAT #####

F.abs.lat.D <- abs(F.res.lat.D)
mean(F.abs.lat.D)

F.abs.lat.P1.R <- abs(F.res.lat.P1.R)
mean(F.abs.lat.P1.R)

F.abs.lat.LLSC <- abs(F.res.lat.LLSC)
mean(F.abs.lat.LLSC)

F.abs.lat.SBLL <- abs(F.res.lat.SBLL)
mean(F.abs.lat.SBLL)

F.abs.lat.BD <- abs(F.res.lat.BD)
mean(F.abs.lat.BD)

F.abs.lat.CPD <- abs(F.res.lat.CPD)
mean(F.abs.lat.CPD)

F.abs.lat.CPL <- abs(F.res.lat.CPL)
mean(F.abs.lat.CPL)

F.abs.lat.PreDL <- abs(F.res.lat.PreDL)
mean(F.abs.lat.PreDL)

F.abs.lat.DbL <- abs(F.res.lat.DbL)
mean(F.abs.lat.DbL)

F.abs.lat.HL <- abs(F.res.lat.HL)
mean(F.abs.lat.HL)

F.abs.lat.HD <- abs(F.res.lat.HD)
mean(F.abs.lat.HD)

F.abs.lat.HW <- abs(F.res.lat.HW)
mean(F.abs.lat.HW)

F.abs.lat.SnL <- abs(F.res.lat.SnL)
mean(F.abs.lat.SnL)

F.abs.lat.OL <- abs(F.res.lat.OL)
mean(F.abs.lat.OL)


##### FORM #####

F.abs.form.D <- abs(F.res.form.D)
mean(F.abs.form.D)

F.abs.form.P1.R <- abs(F.res.form.P1.R)
mean(F.abs.form.P1.R)

F.abs.form.LLSC <- abs(F.res.form.LLSC)
mean(F.abs.form.LLSC)

F.abs.form.SBLL <- abs(F.res.form.SBLL)
mean(F.abs.form.SBLL)

F.abs.form.BD <- abs(F.res.form.BD)
mean(F.abs.form.BD)

F.abs.form.CPD <- abs(F.res.form.CPD)
mean(F.abs.form.CPD)

F.abs.form.CPL <- abs(F.res.form.CPL)
mean(F.abs.form.CPL)

F.abs.form.PreDL <- abs(F.res.form.PreDL)
mean(F.abs.form.PreDL)

F.abs.form.DbL <- abs(F.res.form.DbL)
mean(F.abs.form.DbL)

F.abs.form.HL <- abs(F.res.form.HL)
mean(F.abs.form.HL)

F.abs.form.HD <- abs(F.res.form.HD)
mean(F.abs.form.HD)

F.abs.form.HW <- abs(F.res.form.HW)
mean(F.abs.form.HW)

F.abs.form.SnL <- abs(F.res.form.SnL)
mean(F.abs.form.SnL)

F.abs.form.OL <- abs(F.res.form.OL)
mean(F.abs.form.OL)

##### MEX #####

F.abs.mex.D <- abs(F.res.mex.D)
mean(F.abs.mex.D)

F.abs.mex.P1.R <- abs(F.res.mex.P1.R)
mean(F.abs.mex.P1.R)

F.abs.mex.LLSC <- abs(F.res.mex.LLSC)
mean(F.abs.mex.LLSC)

F.abs.mex.SBLL <- abs(F.res.mex.SBLL)
mean(F.abs.mex.SBLL)

F.abs.mex.BD <- abs(F.res.mex.BD)
mean(F.abs.mex.BD)

F.abs.mex.CPD <- abs(F.res.mex.CPD)
mean(F.abs.mex.CPD)

F.abs.mex.CPL <- abs(F.res.mex.CPL)
mean(F.abs.mex.CPL)

F.abs.mex.PreDL <- abs(F.res.mex.PreDL)
mean(F.abs.mex.PreDL)

F.abs.mex.DbL <- abs(F.res.mex.DbL)
mean(F.abs.mex.DbL)

F.abs.mex.HL <- abs(F.res.mex.HL)
mean(F.abs.mex.HL)

F.abs.mex.HD <- abs(F.res.mex.HD)
mean(F.abs.mex.HD)

F.abs.mex.HW <- abs(F.res.mex.HW)
mean(F.abs.mex.HW)

F.abs.mex.SnL <- abs(F.res.mex.SnL)
mean(F.abs.mex.SnL)

F.abs.mex.OL <- abs(F.res.mex.OL)
mean(F.abs.mex.OL)


#let's get this into the raw1 data set so that we can plot this more easily

F.abs.res.D <- c(F.abs.lat.D, F.abs.form.D, F.abs.mex.D)
F.abs.res.P1.R <- c(F.abs.lat.P1.R, F.abs.form.P1.R, F.abs.mex.P1.R)
F.abs.res.LLSC<- c(F.abs.lat.LLSC, F.abs.form.LLSC, F.abs.mex.LLSC)
F.abs.res.SBLL<- c(F.abs.lat.SBLL, F.abs.form.SBLL, F.abs.mex.SBLL)
F.abs.res.BD<- c(F.abs.lat.BD, F.abs.form.BD, F.abs.mex.BD)
F.abs.res.CPD<- c(F.abs.lat.CPD, F.abs.form.CPD, F.abs.mex.CPD)
F.abs.res.CPL<- c(F.abs.lat.CPL, F.abs.form.CPL, F.abs.mex.CPL)
F.abs.res.PreDL <- c(F.abs.lat.PreDL, F.abs.form.PreDL, F.abs.mex.PreDL)
F.abs.res.DbL <- c(F.abs.lat.DbL, F.abs.form.DbL, F.abs.mex.DbL)
F.abs.res.HL<- c(F.abs.lat.HL, F.abs.form.HL, F.abs.mex.HL)
F.abs.res.HD<- c(F.abs.lat.HD, F.abs.form.HD, F.abs.mex.HD)
F.abs.res.HW <- c(F.abs.lat.HW, F.abs.form.HW, F.abs.mex.HW)
F.abs.res.SnL <- c(F.abs.lat.SnL, F.abs.form.SnL, F.abs.mex.SnL)
F.abs.res.OL <- c(F.abs.lat.OL, F.abs.form.OL, F.abs.mex.OL)


rawF2 <- cbind(rawF, F.abs.res.D, F.abs.res.P1.R, F.abs.res.LLSC, F.abs.res.SBLL, F.abs.res.BD, F.abs.res.CPD, F.abs.res.CPL, F.abs.res.PreDL, F.abs.res.DbL, F.abs.res.HL, F.abs.res.HD, F.abs.res.HW, F.abs.res.SnL, F.abs.res.OL)

Fraw3 <- rawF2[rawF2$SPP !="p.mexicana", ]




```

### ANOVAs {.tabset .tabset-fade .tabset-pills}

#### Amazon

##### Zones 

```{r}
library(ggplot2)

Flat3 <- rawF2[rawF2$SPP == "p.latipinna", ]

Fform3 <- rawF2[rawF2$SPP == "p.latipinna", ]

FA.D.F <- aov(F.abs.res.D ~ QUARTILE, data=Fform3)
summary(FA.D.F)

ggplot(Fform3, aes(x=factor(QUARTILE), y=F.abs.res.D)) +
  geom_boxplot()


FA.P1.R.F <- aov(F.abs.res.P1.R ~ QUARTILE, data=Fform3)
summary(FA.P1.R.F)

ggplot(Fform3, aes(x=factor(QUARTILE), y=F.abs.res.P1.R)) +
  geom_boxplot()


FA.LLSC.F <- aov(F.abs.res.LLSC ~ QUARTILE, data=Fform3)
summary(FA.LLSC.F)


FA.SBLL.F <- aov(F.abs.res.SBLL ~ QUARTILE, data=Fform3)
summary(FA.SBLL.F)

ggplot(Fform3, aes(x=factor(QUARTILE), y=F.abs.res.SBLL)) +
  geom_boxplot()


FA.BD.F <- aov(F.abs.res.BD ~ QUARTILE, data=Fform3)
summary(FA.BD.F)

ggplot(Fform3, aes(x=factor(QUARTILE), y=F.abs.res.BD)) +
  geom_boxplot()


FA.CPD.F <- aov(F.abs.res.CPD ~ QUARTILE, data=Fform3)
summary(FA.CPD.F)

ggplot(Fform3, aes(x=factor(QUARTILE), y=F.abs.res.CPD)) +
  geom_boxplot()


FA.CPL.F <- aov(F.abs.res.CPL ~ QUARTILE, data=Fform3)
summary(FA.CPL.F)

ggplot(Fform3, aes(x=factor(QUARTILE), y=F.abs.res.CPL)) +
  geom_boxplot()


FA.PreDL.F <- aov(F.abs.res.PreDL ~ QUARTILE, data=Fform3)
summary(FA.PreDL.F)

ggplot(Fform3, aes(x=factor(QUARTILE), y=F.abs.res.PreDL)) +
  geom_boxplot()


FA.DbL.F <- aov(F.abs.res.DbL ~ QUARTILE, data=Fform3)
summary(FA.DbL.F)

ggplot(Fform3, aes(x=factor(QUARTILE), y=F.abs.res.DbL)) +
  geom_boxplot()


FA.HL.F <- aov(F.abs.res.HL ~ QUARTILE, data=Fform3)
summary(FA.HL.F)

ggplot(Fform3, aes(x=factor(QUARTILE), y=F.abs.res.HL)) +
  geom_boxplot()


FA.HD.F <- aov(F.abs.res.HD ~ QUARTILE, data=Fform3)
summary(FA.HD.F)

FA.HW.F <- aov(F.abs.res.HW ~ QUARTILE, data=Fform3)
summary(FA.HW.F)

ggplot(Fform3, aes(x=factor(QUARTILE), y=F.abs.res.HW)) +
  geom_boxplot()


FA.SnL.F <- aov(F.abs.res.SnL ~ QUARTILE, data=Fform3)
summary(FA.SnL.F)

FA.OL.F <- aov(F.abs.res.OL ~ QUARTILE, data=Fform3)
summary(FA.OL.F)

ggplot(Fform3, aes(x=factor(QUARTILE), y=F.abs.res.OL)) +
  geom_boxplot()


```

##### Basins 

```{r}

FA1.D.F <- aov(F.abs.res.D ~ BASIN, data=Fform3)
summary(FA1.D.F)

ggplot(Fform3, aes(x=factor(BASIN), y=F.abs.res.D)) +
  geom_boxplot()


FA1.P1.R.F <- aov(F.abs.res.P1.R ~ BASIN, data=Fform3)
summary(FA1.P1.R.F)

ggplot(Fform3, aes(x=factor(BASIN), y=F.abs.res.P1.R)) +
  geom_boxplot()

FA1.LLSC.F <- aov(F.abs.res.LLSC ~ BASIN, data=Fform3)
summary(FA1.LLSC.F)

ggplot(Fform3, aes(x=factor(BASIN), y=F.abs.res.LLSC)) +
  geom_boxplot()



FA1.SBLL.F <- aov(F.abs.res.SBLL ~ BASIN, data=Fform3)
summary(FA1.SBLL.F)

ggplot(Fform3, aes(x=factor(BASIN), y=F.abs.res.SBLL)) +
  geom_boxplot()

FA1.BD.F <- aov(F.abs.res.BD ~ BASIN, data=Fform3)
summary(FA1.BD.F)

ggplot(Fform3, aes(x=factor(BASIN), y=F.abs.res.BD)) +
  geom_boxplot()

FA1.CPD.F <- aov(F.abs.res.CPD ~ BASIN, data=Fform3)
summary(FA1.CPD.F)

ggplot(Fform3, aes(x=factor(BASIN), y=F.abs.res.CPD)) +
  geom_boxplot()

FA1.CPL.F <- aov(F.abs.res.CPL ~ BASIN, data=Fform3)
summary(FA1.CPL.F)

FA1.PreDL.F <- aov(F.abs.res.PreDL ~ BASIN, data=Fform3)
summary(FA1.PreDL.F)

ggplot(Fform3, aes(x=factor(BASIN), y=F.abs.res.PreDL)) +
  geom_boxplot()

FA1.DbL.F <- aov(F.abs.res.DbL ~ BASIN, data=Fform3)
summary(FA1.DbL.F)

ggplot(Fform3, aes(x=factor(BASIN), y=F.abs.res.DbL)) +
  geom_boxplot()

FA1.HL.F <- aov(F.abs.res.HL ~ BASIN, data=Fform3)
summary(FA1.HL.F)

ggplot(Fform3, aes(x=factor(BASIN), y=F.abs.res.HL)) +
  geom_boxplot()

FA1.HD.F <- aov(F.abs.res.HD ~ BASIN, data=Fform3)
summary(FA1.HD.F)

ggplot(Fform3, aes(x=factor(BASIN), y=F.abs.res.HD)) +
  geom_boxplot()

FA1.HW.F <- aov(F.abs.res.HW ~ BASIN, data=Fform3)
summary(FA1.HW.F)

ggplot(Fform3, aes(x=factor(BASIN), y=F.abs.res.HW)) +
  geom_boxplot()

FA1.SnL.F <- aov(F.abs.res.SnL ~ BASIN, data=Fform3)
summary(FA1.SnL.F)

FA1.OL.F <- aov(F.abs.res.OL ~ BASIN, data=Fform3)
summary(FA1.OL.F)

ggplot(Fform3, aes(x=factor(BASIN), y=F.abs.res.OL)) +
  geom_boxplot()




```

##### Watersheds 

```{r}

FA2.D.F <- aov(F.abs.res.D ~ WATERSHED, data=Fform3)
summary(FA2.D.F)

ggplot(Fform3, aes(x=factor(WATERSHED), y=F.abs.res.D)) +
  geom_boxplot()


FA2.P1.R.F <- aov(F.abs.res.P1.R ~ WATERSHED, data=Fform3)
summary(FA2.P1.R.F)

ggplot(Fform3, aes(x=factor(WATERSHED), y=F.abs.res.P1.R)) +
  geom_boxplot()

FA2.LLSC.F <- aov(F.abs.res.LLSC ~ WATERSHED, data=Fform3)
summary(FA2.LLSC.F)

ggplot(Fform3, aes(x=factor(WATERSHED), y=F.abs.res.LLSC)) +
  geom_boxplot()



FA2.SBLL.F <- aov(F.abs.res.SBLL ~ WATERSHED, data=Fform3)
summary(FA2.SBLL.F)

ggplot(Fform3, aes(x=factor(WATERSHED), y=F.abs.res.SBLL)) +
  geom_boxplot()

FA2.BD.F <- aov(F.abs.res.BD ~ WATERSHED, data=Fform3)
summary(FA2.BD.F)

ggplot(Fform3, aes(x=factor(WATERSHED), y=F.abs.res.BD)) +
  geom_boxplot()

FA2.CPD.F <- aov(F.abs.res.CPD ~ WATERSHED, data=Fform3)
summary(FA2.CPD.F)

ggplot(Fform3, aes(x=factor(WATERSHED), y=F.abs.res.CPD)) +
  geom_boxplot()

FA2.CPL.F <- aov(F.abs.res.CPL ~ WATERSHED, data=Fform3)
summary(FA2.CPL.F)

FA2.PreDL.F <- aov(F.abs.res.PreDL ~ WATERSHED, data=Fform3)
summary(FA2.PreDL.F)

FA2.DbL.F <- aov(F.abs.res.DbL ~ WATERSHED, data=Fform3)
summary(FA2.DbL.F)

ggplot(Fform3, aes(x=factor(WATERSHED), y=F.abs.res.DbL)) +
  geom_boxplot()

FA2.HL.F <- aov(F.abs.res.HL ~ WATERSHED, data=Fform3)
summary(FA2.HL.F)

ggplot(Fform3, aes(x=factor(WATERSHED), y=F.abs.res.HL)) +
  geom_boxplot()

FA2.HD.F <- aov(F.abs.res.HD ~ WATERSHED, data=Fform3)
summary(FA2.HD.F)

ggplot(Fform3, aes(x=factor(WATERSHED), y=F.abs.res.HD)) +
  geom_boxplot()

FA2.HW.F <- aov(F.abs.res.HW ~ WATERSHED, data=Fform3)
summary(FA2.HW.F)

ggplot(Fform3, aes(x=factor(WATERSHED), y=F.abs.res.HW)) +
  geom_boxplot()

FA2.SnL.F <- aov(F.abs.res.SnL ~ WATERSHED, data=Fform3)
summary(FA2.SnL.F)

FA2.OL.F <- aov(F.abs.res.OL ~ WATERSHED, data=Fform3)
summary(FA2.OL.F)

ggplot(Fform3, aes(x=factor(WATERSHED), y=F.abs.res.OL)) +
  geom_boxplot()




```

#### Sailfin


##### Zones 

```{r}
library(ggplot2)

FA.D.L <- aov(F.abs.res.D ~ QUARTILE, data=Flat3)
summary(FA.D.L)

ggplot(Flat3, aes(x=factor(QUARTILE), y=F.abs.res.D)) +
  geom_boxplot()



FA.P1.R.L <- aov(F.abs.res.P1.R ~ QUARTILE, data=Flat3)
summary(FA.P1.R.L)

ggplot(Flat3, aes(x=factor(QUARTILE), y=F.abs.res.P1.R)) +
  geom_boxplot()


FA.LLSC.L <- aov(F.abs.res.LLSC ~ QUARTILE, data=Flat3)
summary(FA.LLSC.L)


FA.SBLL.L <- aov(F.abs.res.SBLL ~ QUARTILE, data=Flat3)
summary(FA.SBLL.L)

ggplot(Flat3, aes(x=factor(QUARTILE), y=F.abs.res.SBLL)) +
  geom_boxplot()


FA.BD.L <- aov(F.abs.res.BD ~ QUARTILE, data=Flat3)
summary(FA.BD.L)

ggplot(Flat3, aes(x=factor(QUARTILE), y=F.abs.res.BD)) +
  geom_boxplot()


FA.CPD.L <- aov(F.abs.res.CPD ~ QUARTILE, data=Flat3)
summary(FA.CPD.L)

ggplot(Flat3, aes(x=factor(QUARTILE), y=F.abs.res.CPD)) +
  geom_boxplot()


FA.CPL.L <- aov(F.abs.res.CPL ~ QUARTILE, data=Flat3)
summary(FA.CPL.L)

ggplot(Flat3, aes(x=factor(QUARTILE), y=F.abs.res.CPL)) +
  geom_boxplot()


FA.PreDL.L <- aov(F.abs.res.PreDL ~ QUARTILE, data=Flat3)
summary(FA.PreDL.L)

ggplot(Flat3, aes(x=factor(QUARTILE), y=F.abs.res.PreDL)) +
  geom_boxplot()


FA.DbL.L <- aov(F.abs.res.DbL ~ QUARTILE, data=Flat3)
summary(FA.DbL.L)

ggplot(Flat3, aes(x=factor(QUARTILE), y=F.abs.res.DbL)) +
  geom_boxplot()


FA.HL.L <- aov(F.abs.res.HL ~ QUARTILE, data=Flat3)
summary(FA.HL.L)

ggplot(Flat3, aes(x=factor(QUARTILE), y=F.abs.res.HL)) +
  geom_boxplot()


FA.HD.L <- aov(F.abs.res.HD ~ QUARTILE, data=Flat3)
summary(FA.HD.L)

FA.HW.L <- aov(F.abs.res.HW ~ QUARTILE, data=Flat3)
summary(FA.HW.L)

ggplot(Flat3, aes(x=factor(QUARTILE), y=F.abs.res.HW)) +
  geom_boxplot()


FA.SnL.L <- aov(F.abs.res.SnL ~ QUARTILE, data=Flat3)
summary(FA.SnL.L)

FA.OL.L <- aov(F.abs.res.OL ~ QUARTILE, data=Flat3)
summary(FA.OL.L)

ggplot(Flat3, aes(x=factor(QUARTILE), y=F.abs.res.OL)) +
  geom_boxplot()


```

##### Basins 

```{r}

FA1.D.L <- aov(F.abs.res.D ~ BASIN, data=Flat3)
summary(FA1.D.L)

ggplot(Flat3, aes(x=factor(BASIN), y=F.abs.res.D)) +
  geom_boxplot()


FA1.P1.R.L <- aov(F.abs.res.P1.R ~ BASIN, data=Flat3)
summary(FA1.P1.R.L)

ggplot(Flat3, aes(x=factor(BASIN), y=F.abs.res.P1.R)) +
  geom_boxplot()

FA1.LLSC.L <- aov(F.abs.res.LLSC ~ BASIN, data=Flat3)
summary(FA1.LLSC.L)

ggplot(Flat3, aes(x=factor(BASIN), y=F.abs.res.LLSC)) +
  geom_boxplot()



FA1.SBLL.L <- aov(F.abs.res.SBLL ~ BASIN, data=Flat3)
summary(FA1.SBLL.L)

ggplot(Flat3, aes(x=factor(BASIN), y=F.abs.res.SBLL)) +
  geom_boxplot()

FA1.BD.L <- aov(F.abs.res.BD ~ BASIN, data=Flat3)
summary(FA1.BD.L)

ggplot(Flat3, aes(x=factor(BASIN), y=F.abs.res.BD)) +
  geom_boxplot()

FA1.CPD.L <- aov(F.abs.res.CPD ~ BASIN, data=Flat3)
summary(FA1.CPD.L)

ggplot(Flat3, aes(x=factor(BASIN), y=F.abs.res.CPD)) +
  geom_boxplot()

FA1.CPL.L <- aov(F.abs.res.CPL ~ BASIN, data=Flat3)
summary(FA1.CPL.L)

FA1.PreDL.L <- aov(F.abs.res.PreDL ~ BASIN, data=Flat3)
summary(FA1.PreDL.L)

ggplot(Flat3, aes(x=factor(BASIN), y=F.abs.res.PreDL)) +
  geom_boxplot()

FA1.DbL.L <- aov(F.abs.res.DbL ~ BASIN, data=Flat3)
summary(FA1.DbL.L)

ggplot(Flat3, aes(x=factor(BASIN), y=F.abs.res.DbL)) +
  geom_boxplot()

FA1.HL.L <- aov(F.abs.res.HL ~ BASIN, data=Flat3)
summary(FA1.HL.L)

ggplot(Flat3, aes(x=factor(BASIN), y=F.abs.res.HL)) +
  geom_boxplot()

FA1.HD.L <- aov(F.abs.res.HD ~ BASIN, data=Flat3)
summary(FA1.HD.L)

ggplot(Flat3, aes(x=factor(BASIN), y=F.abs.res.HD)) +
  geom_boxplot()

FA1.HW.L <- aov(F.abs.res.HW ~ BASIN, data=Flat3)
summary(FA1.HW.L)

ggplot(Flat3, aes(x=factor(BASIN), y=F.abs.res.HW)) +
  geom_boxplot()

FA1.SnL.L <- aov(F.abs.res.SnL ~ BASIN, data=Flat3)
summary(FA1.SnL.L)

FA1.OL.L <- aov(F.abs.res.OL ~ BASIN, data=Flat3)
summary(FA1.OL.L)

ggplot(Flat3, aes(x=factor(BASIN), y=F.abs.res.OL)) +
  geom_boxplot()




```

##### Watersheds 

```{r}

FA2.D.L <- aov(F.abs.res.D ~ WATERSHED, data=Flat3)
summary(FA2.D.L)

ggplot(Flat3, aes(x=factor(WATERSHED), y=F.abs.res.D)) +
  geom_boxplot()


ggplot(Flat3, aes(x=factor(WATERSHED), y=F.abs.res.P1.R)) +
  geom_boxplot()

FA2.LLSC.L <- aov(F.abs.res.LLSC ~ WATERSHED, data=Flat3)
summary(FA2.LLSC.L)

ggplot(Flat3, aes(x=factor(WATERSHED), y=F.abs.res.LLSC)) +
  geom_boxplot()



FA2.SBLL.L <- aov(F.abs.res.SBLL ~ WATERSHED, data=Flat3)
summary(FA2.SBLL.L)

ggplot(Flat3, aes(x=factor(WATERSHED), y=F.abs.res.SBLL)) +
  geom_boxplot()

FA2.BD.L <- aov(F.abs.res.BD ~ WATERSHED, data=Flat3)
summary(FA2.BD.L)

ggplot(Flat3, aes(x=factor(WATERSHED), y=F.abs.res.BD)) +
  geom_boxplot()

FA2.CPD.L <- aov(F.abs.res.CPD ~ WATERSHED, data=Flat3)
summary(FA2.CPD.L)

ggplot(Flat3, aes(x=factor(WATERSHED), y=F.abs.res.CPD)) +
  geom_boxplot()

FA2.CPL.L <- aov(F.abs.res.CPL ~ WATERSHED, data=Flat3)
summary(FA2.CPL.L)

FA2.PreDL.L <- aov(F.abs.res.PreDL ~ WATERSHED, data=Flat3)
summary(FA2.PreDL.L)

FA2.DbL.L <- aov(F.abs.res.DbL ~ WATERSHED, data=Flat3)
summary(FA2.DbL.L)

ggplot(Flat3, aes(x=factor(WATERSHED), y=F.abs.res.DbL)) +
  geom_boxplot()

FA2.HL.L <- aov(F.abs.res.HL ~ WATERSHED, data=Flat3)
summary(FA2.HL.L)

ggplot(Flat3, aes(x=factor(WATERSHED), y=F.abs.res.HL)) +
  geom_boxplot()

FA2.HD.L <- aov(F.abs.res.HD ~ WATERSHED, data=Flat3)
summary(FA2.HD.L)

ggplot(Flat3, aes(x=factor(WATERSHED), y=F.abs.res.HD)) +
  geom_boxplot()

FA2.HW.L <- aov(F.abs.res.HW ~ WATERSHED, data=Flat3)
summary(FA2.HW.L)

ggplot(Flat3, aes(x=factor(WATERSHED), y=F.abs.res.HW)) +
  geom_boxplot()

FA2.SnL.L <- aov(F.abs.res.SnL ~ WATERSHED, data=Flat3)
summary(FA2.SnL.L)

FA2.OL.L <- aov(F.abs.res.OL ~ WATERSHED, data=Flat3)
summary(FA2.OL.L)

ggplot(Flat3, aes(x=factor(WATERSHED), y=F.abs.res.OL)) +
  geom_boxplot()




```

#### Both

##### Zones 

```{r}
library(ggplot2)

FA.D <- aov(F.abs.res.D ~ SPP*QUARTILE, data=Fraw3)
summary(FA.D)

ggplot(Fraw3, aes(x=factor(QUARTILE), y=F.abs.res.D, fill=SPP)) +
  geom_boxplot()


FA.P1.R <- aov(F.abs.res.P1.R ~ SPP*QUARTILE, data=Fraw3)
summary(FA.P1.R)

ggplot(Fraw3, aes(x=factor(QUARTILE), y=F.abs.res.P1.R, fill=SPP)) +
  geom_boxplot()


FA.LLSC <- aov(F.abs.res.LLSC ~ SPP*QUARTILE, data=Fraw3)
summary(FA.LLSC)


FA.SBLL <- aov(F.abs.res.SBLL ~ SPP*QUARTILE, data=Fraw3)
summary(FA.SBLL)

ggplot(Fraw3, aes(x=factor(QUARTILE), y=F.abs.res.SBLL, fill=SPP)) +
  geom_boxplot()


FA.BD <- aov(F.abs.res.BD ~ SPP*QUARTILE, data=Fraw3)
summary(FA.BD)

ggplot(Fraw3, aes(x=factor(QUARTILE), y=F.abs.res.BD, fill=SPP)) +
  geom_boxplot()


FA.CPD <- aov(F.abs.res.CPD ~ SPP*QUARTILE, data=Fraw3)
summary(FA.CPD)

ggplot(Fraw3, aes(x=factor(QUARTILE), y=F.abs.res.CPD, fill=SPP)) +
  geom_boxplot()


FA.CPL <- aov(F.abs.res.CPL ~ SPP*QUARTILE, data=Fraw3)
summary(FA.CPL)

ggplot(Fraw3, aes(x=factor(QUARTILE), y=F.abs.res.CPL, fill=SPP)) +
  geom_boxplot()


FA.PreDL <- aov(F.abs.res.PreDL ~ SPP*QUARTILE, data=Fraw3)
summary(FA.PreDL)

ggplot(Fraw3, aes(x=factor(QUARTILE), y=F.abs.res.PreDL, fill=SPP)) +
  geom_boxplot()


FA.DbL <- aov(F.abs.res.DbL ~ SPP*QUARTILE, data=Fraw3)
summary(FA.DbL)

ggplot(Fraw3, aes(x=factor(QUARTILE), y=F.abs.res.DbL, fill=SPP)) +
  geom_boxplot()


FA.HL <- aov(F.abs.res.HL ~ SPP*QUARTILE, data=Fraw3)
summary(FA.HL)

ggplot(Fraw3, aes(x=factor(QUARTILE), y=F.abs.res.HL, fill=SPP)) +
  geom_boxplot()


FA.HD <- aov(F.abs.res.HD ~ SPP*QUARTILE, data=Fraw3)
summary(FA.HD)

FA.HW <- aov(F.abs.res.HW ~ SPP*QUARTILE, data=Fraw3)
summary(FA.HW)

ggplot(Fraw3, aes(x=factor(QUARTILE), y=F.abs.res.HW, fill=SPP)) +
  geom_boxplot()


FA.SnL <- aov(F.abs.res.SnL ~ SPP*QUARTILE, data=Fraw3)
summary(FA.SnL)

FA.OL <- aov(F.abs.res.OL ~ SPP*QUARTILE, data=Fraw3)
summary(FA.OL)

ggplot(Fraw3, aes(x=factor(QUARTILE), y=F.abs.res.OL, fill=SPP)) +
  geom_boxplot()


```

##### Basins 

```{r}

FA1.D <- aov(F.abs.res.D ~ SPP*BASIN, data=Fraw3)
summary(FA1.D)

ggplot(Fraw3, aes(x=factor(BASIN), y=F.abs.res.D, fill=SPP)) +
  geom_boxplot()

FA1.P1.R <- aov(F.abs.res.P1.R ~ SPP*BASIN, data=Fraw3)
summary(FA1.P1.R)

ggplot(Fraw3, aes(x=factor(BASIN), y=F.abs.res.P1.R, fill=SPP)) +
  geom_boxplot()

FA1.LLSC <- aov(F.abs.res.LLSC ~ SPP*BASIN, data=Fraw3)
summary(FA1.LLSC)

ggplot(Fraw3, aes(x=factor(BASIN), y=F.abs.res.LLSC, fill=SPP)) +
  geom_boxplot()



FA1.SBLL <- aov(F.abs.res.SBLL ~ SPP*BASIN, data=Fraw3)
summary(FA1.SBLL)

ggplot(Fraw3, aes(x=factor(BASIN), y=F.abs.res.SBLL, fill=SPP)) +
  geom_boxplot()

FA1.BD <- aov(F.abs.res.BD ~ SPP*BASIN, data=Fraw3)
summary(FA1.BD)

ggplot(Fraw3, aes(x=factor(BASIN), y=F.abs.res.BD, fill=SPP)) +
  geom_boxplot()

FA1.CPD <- aov(F.abs.res.CPD ~ SPP*BASIN, data=Fraw3)
summary(FA1.CPD)

ggplot(Fraw3, aes(x=factor(BASIN), y=F.abs.res.CPD, fill=SPP)) +
  geom_boxplot()

FA1.CPL <- aov(F.abs.res.CPL ~ SPP*BASIN, data=Fraw3)
summary(FA1.CPL)

FA1.PreDL <- aov(F.abs.res.PreDL ~ SPP*BASIN, data=Fraw3)
summary(FA1.PreDL)

ggplot(Fraw3, aes(x=factor(BASIN), y=F.abs.res.PreDL, fill=SPP)) +
  geom_boxplot()

FA1.DbL <- aov(F.abs.res.DbL ~ SPP*BASIN, data=Fraw3)
summary(FA1.DbL)

ggplot(Fraw3, aes(x=factor(BASIN), y=F.abs.res.DbL, fill=SPP)) +
  geom_boxplot()

FA1.HL <- aov(F.abs.res.HL ~ SPP*BASIN, data=Fraw3)
summary(FA1.HL)

ggplot(Fraw3, aes(x=factor(BASIN), y=F.abs.res.HL, fill=SPP)) +
  geom_boxplot()

FA1.HD <- aov(F.abs.res.HD ~ SPP*BASIN, data=Fraw3)
summary(FA1.HD)

ggplot(Fraw3, aes(x=factor(BASIN), y=F.abs.res.HD, fill=SPP)) +
  geom_boxplot()

FA1.HW <- aov(F.abs.res.HW ~ SPP*BASIN, data=Fraw3)
summary(FA1.HW)

ggplot(Fraw3, aes(x=factor(BASIN), y=F.abs.res.HW, fill=SPP)) +
  geom_boxplot()

FA1.SnL <- aov(F.abs.res.SnL ~ SPP*BASIN, data=Fraw3)
summary(FA1.SnL)

FA1.OL <- aov(F.abs.res.OL ~ SPP*BASIN, data=Fraw3)
summary(FA1.OL)

ggplot(Fraw3, aes(x=factor(BASIN), y=F.abs.res.OL, fill=SPP)) +
  geom_boxplot()




```

##### Watersheds 

```{r}

FA2.D <- aov(F.abs.res.D ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.D)

ggplot(Fraw3, aes(x=factor(WATERSHED), y=F.abs.res.D, fill=SPP)) +
  geom_boxplot()

FA2.P1.R <- aov(F.abs.res.P1.R ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.P1.R)

ggplot(Fraw3, aes(x=factor(WATERSHED), y=F.abs.res.P1.R, fill=SPP)) +
  geom_boxplot()

FA2.LLSC <- aov(F.abs.res.LLSC ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.LLSC)

ggplot(Fraw3, aes(x=factor(WATERSHED), y=F.abs.res.LLSC, fill=SPP)) +
  geom_boxplot()



FA2.SBLL <- aov(F.abs.res.SBLL ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.SBLL)

ggplot(Fraw3, aes(x=factor(WATERSHED), y=F.abs.res.SBLL, fill=SPP)) +
  geom_boxplot()

FA2.BD <- aov(F.abs.res.BD ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.BD)

ggplot(Fraw3, aes(x=factor(WATERSHED), y=F.abs.res.BD, fill=SPP)) +
  geom_boxplot()

FA2.CPD <- aov(F.abs.res.CPD ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.CPD)

ggplot(Fraw3, aes(x=factor(WATERSHED), y=F.abs.res.CPD, fill=SPP)) +
  geom_boxplot()

FA2.CPL <- aov(F.abs.res.CPL ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.CPL)

FA2.PreDL <- aov(F.abs.res.PreDL ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.PreDL)

FA2.DbL <- aov(F.abs.res.DbL ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.DbL)

ggplot(Fraw3, aes(x=factor(WATERSHED), y=F.abs.res.DbL, fill=SPP)) +
  geom_boxplot()

FA2.HL <- aov(F.abs.res.HL ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.HL)

ggplot(Fraw3, aes(x=factor(WATERSHED), y=F.abs.res.HL, fill=SPP)) +
  geom_boxplot()

FA2.HD <- aov(F.abs.res.HD ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.HD)

ggplot(Fraw3, aes(x=factor(WATERSHED), y=F.abs.res.HD, fill=SPP)) +
  geom_boxplot()

FA2.HW <- aov(F.abs.res.HW ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.HW)

ggplot(Fraw3, aes(x=factor(WATERSHED), y=F.abs.res.HW, fill=SPP)) +
  geom_boxplot()

FA2.SnL <- aov(F.abs.res.SnL ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.SnL)

FA2.OL <- aov(F.abs.res.OL ~ SPP*WATERSHED, data=Fraw3)
summary(FA2.OL)

ggplot(Fraw3, aes(x=factor(WATERSHED), y=F.abs.res.OL, fill=SPP)) +
  geom_boxplot()




```


### GLMMs

Will run mixed models with zones/basins/watersheds as random effect. This will account for any variation seen at these levels and show us if there are any consistent species differences. Can only do this with residuals. 

#### Zones

```{r}
library(lme4)
library(lmerTest)


FMM.D <- glmer(F.abs.res.D ~ SPP + (1|QUARTILE), data=Fraw3)#originally had family=poisson, since this is count data, but because this was the residuals of count data, the values were non-integers and poisson only deals with integers. 
FMM.D.a <- anova(FMM.D, test="Chisq")
summary(FMM.D.a)

FMM.P1.R <- glmer(F.abs.res.P1.R ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.P1.Ra <- anova(FMM.P1.R, test="Chisq")
summary(FMM.P1.Ra)

FMM.LLSC <- glmer(F.abs.res.LLSC ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.LLSC.a <- anova(FMM.LLSC, test="Chisq")
summary(FMM.LLSC.a)


FMM.SBLL <- glmer(F.abs.res.SBLL ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.SBLL.a <- anova(FMM.SBLL, test="Chisq")
summary(FMM.SBLL.a)


FMM.BD <- glmer(F.abs.res.BD ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.BD.a <- anova(FMM.BD, test="Chisq")
summary(FMM.BD.a)


FMM.CPD <- glmer(F.abs.res.CPD ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.CPD.a <- anova(FMM.CPD, test="Chisq")
summary(FMM.CPD.a)


FMM.CPL <- glmer(F.abs.res.CPL ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.CPL.a <- anova(FMM.CPL, test="Chisq")
summary(FMM.CPL.a)

FMM.PreDL <- glmer(F.abs.res.PreDL ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.PreDL.a <- anova(FMM.PreDL, test="Chisq")
summary(FMM.PreDL.a)

FMM.DbL <- glmer(F.abs.res.DbL ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.DbL.a <- anova(FMM.DbL, test="Chisq")
summary(FMM.DbL.a)

FMM.HL <- glmer(F.abs.res.HL ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.HL.a <- anova(FMM.HL, test="Chisq")
summary(FMM.HL.a)

FMM.HD <- glmer(F.abs.res.HD ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.HD.a <- anova(FMM.HD, test="Chisq")
summary(FMM.HD.a)

FMM.HW <- glmer(F.abs.res.HW ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.HW.a <- anova(FMM.HW, test="Chisq")
summary(FMM.HW.a)

FMM.SnL <- glmer(F.abs.res.SnL ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.SnL.a <- anova(FMM.SnL, test="Chisq")
summary(FMM.SnL.a)

FMM.OL <- glmer(F.abs.res.OL ~ SPP+ (1|QUARTILE), data=Fraw3)
FMM.OL.a <- anova(FMM.OL, test="Chisq")
summary(FMM.OL.a)



```



#### Watershed nested in Basin

```{r}

FMM1.D <- glmer(F.abs.res.D ~ SPP + (1|BASIN/WATERSHED), data=Fraw3)
FMM1.D.a <- anova(FMM1.D, test="Chisq")
summary(FMM1.D.a)

FMM1.P1.R <- glmer(F.abs.res.P1.R ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.P1.Ra <- anova(FMM1.P1.R, test="Chisq")
summary(FMM1.P1.Ra)

FMM1.LLSC <- glmer(F.abs.res.LLSC ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.LLSC.a <- anova(FMM1.LLSC, test="Chisq")
summary(FMM1.LLSC.a)

FMM1.SBLL <- glmer(F.abs.res.SBLL ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.SBLL.a <- anova(FMM1.SBLL, test="Chisq")
summary(FMM1.SBLL.a)

FMM1.BD <- glmer(F.abs.res.BD ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.BD.a <- anova(FMM1.BD, test="Chisq")
summary(FMM1.BD.a)

FMM1.CPD <- glmer(F.abs.res.CPD ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.CPD.a <- anova(FMM1.CPD, test="Chisq")
summary(FMM1.CPD.a)

FMM1.CPL <- glmer(F.abs.res.CPL ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.CPL.a <- anova(FMM1.CPL, test="Chisq")
summary(FMM1.CPL.a)

FMM1.PreDL <- glmer(F.abs.res.PreDL ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.PreDL.a <- anova(FMM1.PreDL, test="Chisq")
summary(FMM1.PreDL.a)

FMM1.DbL <- glmer(F.abs.res.DbL ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.DbL.a <- anova(FMM1.DbL, test="Chisq")
summary(FMM1.DbL.a)

FMM1.HL <- glmer(F.abs.res.HL ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.HL.a <- anova(FMM1.HL, test="Chisq")
summary(FMM1.HL.a)

FMM1.HD <- glmer(F.abs.res.HD ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.HD.a <- anova(FMM1.HD, test="Chisq")
summary(FMM1.HD.a)

FMM1.HW <- glmer(F.abs.res.HW ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.HW.a <- anova(FMM1.HW, test="Chisq")
summary(FMM1.HW.a)

FMM1.SnL <- glmer(F.abs.res.SnL ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.SnL.a <- anova(FMM1.SnL, test="Chisq")
summary(FMM1.SnL.a)

FMM1.OL <- glmer(F.abs.res.OL ~ SPP+ (1|BASIN/WATERSHED), data=Fraw3)
FMM1.OL.a <- anova(FMM1.OL, test="Chisq")
summary(FMM1.OL.a)


```


***

### Levene's w/ Basin?

Not sure if this is correct, but might try Levene's test with zone/basin/watershed as an additional independent factor? This is for the traits that did NOT vary with body length.


#### Zones

```{r}
library(car)

(FLT2_P2L <- leveneTest(P2.L~SPP*QUARTILE, data=Fraw3)) #gives nothing since it's all the same value

(FLT2_P2R <- leveneTest(P2.R~SPP*QUARTILE, data=Fraw3)) #same as above

(FLT2_P1 <- leveneTest(P1~SPP*QUARTILE, data=Fraw3))

(FLT2_A <- leveneTest(A~SPP*QUARTILE, data=Fraw3)) 

(FLT2_SALL <- leveneTest(SALL~SPP*QUARTILE, data=Fraw3))

(FLT2_SBLL <- leveneTest(SBLL~SPP*QUARTILE, data=Fraw3))

(FLT2_SBDF <- leveneTest(SBDF~SPP*QUARTILE, data=Fraw3))

(FLT2_FLA <- leveneTest(FLA~SPP*QUARTILE, data=Fraw3))

```

#### Basins

```{r}
(FLT3_P2L <- leveneTest(P2.L~SPP*BASIN, data=Fraw3)) #gives nothing since it's all the same value

(FLT3_P2R <- leveneTest(P2.R~SPP*BASIN, data=Fraw3)) #same as above

(FLT3_P1 <- leveneTest(P1~SPP*BASIN, data=Fraw3))

(FLT3_A <- leveneTest(A~SPP*BASIN, data=Fraw3)) 

(FLT3_SALL <- leveneTest(SALL~SPP*BASIN, data=Fraw3))

(FLT3_SBLL <- leveneTest(SBLL~SPP*BASIN, data=Fraw3))

(FLT3_SBDF <- leveneTest(SBDF~SPP*BASIN, data=Fraw3))

(FLT3_FLA <- leveneTest(FLA~SPP*BASIN, data=Fraw3))

```


#### Watersheds

```{r}
(FLT4_P2L <- leveneTest(P2.L~SPP*WATERSHED, data=Fraw3)) #gives nothing since it's all the same value

(FLT4_P2R <- leveneTest(P2.R~SPP*WATERSHED, data=Fraw3)) #same as above

(FLT4_P1 <- leveneTest(P1~SPP*WATERSHED, data=Fraw3))

(FLT4_A <- leveneTest(A~SPP*WATERSHED, data=Fraw3)) 

(FLT4_SALL <- leveneTest(SALL~SPP*WATERSHED, data=Fraw3))

(FLT4_SBLL <- leveneTest(SBLL~SPP*WATERSHED, data=Fraw3))

(FLT4_SBDF <- leveneTest(SBDF~SPP*WATERSHED, data=Fraw3))

(FLT4_FLA <- leveneTest(FLA~SPP*WATERSHED, data=Fraw3))

```



